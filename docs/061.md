# æ€§èƒ½ API ç®€ä»‹

> åŸæ–‡:[https://kinsta.com/blog/performance-api/](https://kinsta.com/blog/performance-api/)

[Performance API](https://developer.mozilla.org/docs/Web/API/Performance_API) æµ‹é‡çœŸå®ç”¨æˆ·è®¾å¤‡å’Œç½‘ç»œè¿æ¥ä¸Šçš„å®æ—¶ web åº”ç”¨ç¨‹åºçš„å“åº”æ€§ã€‚å®ƒå¯ä»¥å¸®åŠ©æ‚¨è¯†åˆ«å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä»£ç ä¸­çš„ç“¶é¢ˆ:

*   **ç”¨æˆ·è®¡æ—¶:**è‡ªå®šä¹‰æµ‹é‡å®¢æˆ·ç«¯ [JavaScript å‡½æ•°](https://kinsta.com/knowledgebase/what-is-javascript/)æ€§èƒ½
*   **ç»˜åˆ¶æ—¶é—´:**æµè§ˆå™¨æ¸²æŸ“æŒ‡æ ‡
*   **èµ„æºè®¡æ—¶:**åŠ è½½æ€§èƒ½èµ„äº§å’Œ Ajax è°ƒç”¨
*   **å¯¼èˆªæ—¶é—´:**é¡µé¢åŠ è½½æŒ‡æ ‡ï¼ŒåŒ…æ‹¬é‡å®šå‘ã€DNS æŸ¥æ‰¾ã€DOM å°±ç»ªç­‰

API è§£å†³äº†ä¸å…¸å‹æ€§èƒ½è¯„ä¼°ç›¸å…³çš„å‡ ä¸ªé—®é¢˜:

1.  å¼€å‘äººå‘˜ç»å¸¸åœ¨è¿æ¥åˆ°é«˜é€Ÿç½‘ç»œçš„é«˜ç«¯ç”µè„‘ä¸Šæµ‹è¯•åº”ç”¨ç¨‹åºã€‚DevTools å¯ä»¥æ¨¡æ‹Ÿè¾ƒæ…¢çš„è®¾å¤‡ï¼Œä½†å½“å¤§å¤šæ•°å®¢æˆ·ç«¯è¿è¡Œçš„æ˜¯è¿æ¥åˆ°æœºåœº WiFi çš„ä¸¤å¹´å‰çš„æ‰‹æœºæ—¶ï¼Œå®ƒä¸ä¼šæ€»æ˜¯çªå‡ºç°å®ä¸–ç•Œçš„é—®é¢˜ã€‚
2.  ç¬¬ä¸‰æ–¹é€‰é¡¹å¦‚[è°·æ­Œåˆ†æ](https://kinsta.com/blog/how-to-use-google-analytics/)ç»å¸¸è¢«å±è”½ï¼Œå¯¼è‡´ç»“æœå’Œå‡è®¾å¤±çœŸã€‚åœ¨æŸäº›å›½å®¶ï¼Œæ‚¨å¯èƒ½è¿˜ä¼šé‡åˆ°éšç§é—®é¢˜ã€‚
3.  æ€§èƒ½ API å¯ä»¥æ¯” [`Date()`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Date) ç­‰æ–¹æ³•æ›´å‡†ç¡®åœ°åº¦é‡å„ç§åº¦é‡ã€‚

[æƒ³äº†è§£æœ‰å…³ä½¿ç”¨æ€§èƒ½ API çš„æ›´å¤šä¿¡æ¯å—ï¼ŸğŸ‘€ä»è¿™é‡Œå¼€å§‹...ğŸš€ ç‚¹å‡»å‘å¸ƒæ¨æ–‡](https://twitter.com/intent/tweet?url=https%3A%2F%2Fbit.ly%2F3dl8OA3&via=kinsta&text=Want+to+learn+more+about+using+the+Performance+API%3F+%F0%9F%91%80+Start+here...+%F0%9F%9A%80&hashtags=API%2CWebDev)
ä»¥ä¸‹ç« èŠ‚æè¿°äº†æ‚¨å¯ä»¥ä½¿ç”¨æ€§èƒ½ API çš„æ–¹å¼ã€‚å»ºè®®äº†è§£ä¸€äº› JavaScript å’Œ[é¡µé¢åŠ è½½æŒ‡æ ‡](https://kinsta.com/blog/website-speed-test/)çš„çŸ¥è¯†ã€‚

 <kinsta-auto-toc heading="Table of Contents" exclude="last" list-style="arrow" selector="h2" count-number="-1"><kinsta-advanced-cta language="en_US" type-int-post="128170" type-int-position="0">## æ€§èƒ½ API å¯ç”¨æ€§

å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒæ€§èƒ½ APIâ€”â€”åŒ…æ‹¬ IE10 å’Œ IE11(ç”šè‡³ IE9 ä¹Ÿæœ‰æœ‰é™çš„æ”¯æŒ)ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ£€æµ‹ API çš„å­˜åœ¨:

<link rel="stylesheet" href="https://kinsta.com/wp-content/themes/kinsta/dist/components/ctas/cta-mini.css?ver=2e932b8aba3918bfb818">

<aside class="sidebar-cta">

> Kinsta æŠŠæˆ‘å® åäº†ï¼Œæ‰€ä»¥æˆ‘ç°åœ¨è¦æ±‚æ¯ä¸ªä¾›åº”å•†éƒ½æä¾›è¿™æ ·çš„æœåŠ¡ã€‚æˆ‘ä»¬è¿˜è¯•å›¾é€šè¿‡æˆ‘ä»¬çš„ SaaS å·¥å…·æ”¯æŒè¾¾åˆ°è¿™ä¸€æ°´å¹³ã€‚
> 
> <footer class="wp-block-kinsta-client-quote__footer">
> 
> <figure class="wp-block-kinsta-client-quote__avatar">![](../Images/60f15faa5735bd2437bf9dada5ee9192.png)</figure>
> 
> <cite class="wp-block-kinsta-client-quote__cite">Suganthan Mohanadasan from @Suganthanmn</cite></footer>

[View plans](https://kinsta.com/plans/)</aside>

```
if ('performance' in window) {
  // use Performance API
}
```

å®Œå…¨å¡«å…… API æ˜¯ä¸å¯èƒ½çš„ï¼Œæ‰€ä»¥è¦å°å¿ƒé—æ¼çš„æµè§ˆå™¨ã€‚å¦‚æœ 90%çš„ç”¨æˆ·éƒ½åœ¨æ„‰å¿«åœ°ä½¿ç”¨ Internet Explorer 8 è¿›è¡Œæµè§ˆï¼Œé‚£ä¹ˆæ‚¨åªèƒ½æµ‹é‡ 10%çš„å®¢æˆ·ç«¯æ‹¥æœ‰æ›´å¼ºå¤§çš„åº”ç”¨ç¨‹åºã€‚

è¯¥ API å¯ä»¥åœ¨ [Web Workers](https://developer.mozilla.org/docs/Web/API/Web_Workers_API/Using_web_workers) ä¸­ä½¿ç”¨ï¼Œå®ƒæä¾›äº†ä¸€ç§åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œå¤æ‚è®¡ç®—è€Œä¸ä¸­æ–­æµè§ˆå™¨æ“ä½œçš„æ–¹æ³•ã€‚

å¤§å¤šæ•° API æ–¹æ³•å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯ Node.js ä¸­ä½¿ç”¨æ ‡å‡†çš„ [perf_hooks æ¨¡å—](https://nodejs.org/dist/latest/docs/api/perf_hooks.html):

```
// Node.js performance
import { performance } from 'node:perf_hooks';
// or in Common JS: const { performance } = require('node:perf_hooks');

console.log( performance.now() );
```

Deno æä¾›äº†æ ‡å‡†çš„[æ€§èƒ½ API](https://doc.deno.land/deno/stable/~/Performance) :

```
// Deno performance
console.log( performance.now() );
```

æ‚¨å°†éœ€è¦ä½¿ç”¨`--allow-hrtime`æƒé™è¿è¡Œè„šæœ¬æ¥å¯ç”¨é«˜åˆ†è¾¨ç‡æ—¶é—´æµ‹é‡:

```
deno run --allow-hrtime index.js
```

æœåŠ¡å™¨ç«¯æ€§èƒ½é€šå¸¸æ›´å®¹æ˜“è¯„ä¼°å’Œç®¡ç†ï¼Œå› ä¸ºå®ƒå–å†³äºè´Ÿè½½ã€CPUã€RAMã€ç¡¬ç›˜å’Œ[äº‘æœåŠ¡é™åˆ¶](https://kinsta.com/blog/disk-space-wordpress-hosting/)ã€‚ç¡¬ä»¶å‡çº§æˆ–è¿‡ç¨‹ç®¡ç†é€‰é¡¹ï¼Œå¦‚ [PM2](https://pm2.keymetrics.io/) ã€[é›†ç¾¤](https://nodejs.org/api/cluster.html)å’Œ [Kubernetes](https://kubernetes.io/) å¯èƒ½æ¯”é‡æ„ä»£ç æ›´æœ‰æ•ˆã€‚

å‡ºäºè¿™ä¸ªåŸå› ï¼Œä¸‹é¢å‡ èŠ‚é›†ä¸­è®¨è®ºå®¢æˆ·ç«¯æ€§èƒ½ã€‚

## è‡ªå®šä¹‰æ€§èƒ½æµ‹é‡

Performance API å¯ä»¥ç”¨æ¥è®¡æ—¶åº”ç”¨ç¨‹åºå‡½æ•°çš„æ‰§è¡Œé€Ÿåº¦ã€‚æ‚¨å¯èƒ½ä½¿ç”¨è¿‡æˆ–é‡åˆ°è¿‡ä½¿ç”¨ [`Date()`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Date) çš„è®¡æ—¶åŠŸèƒ½:

```
const timeStart = new Date();
runMyCode();
const timeTaken = new Date() - timeStart;

console.log(`runMyCode() executed in ${ timeTaken }ms`);
```

æ€§èƒ½ API æä¾›äº†ä¸¤ä¸ªä¸»è¦å¥½å¤„:

1.  **æ›´å¥½çš„å‡†ç¡®æ€§:** `Date()`æµ‹é‡åˆ°æœ€æ¥è¿‘çš„æ¯«ç§’ï¼Œä½†æ˜¯æ€§èƒ½ API å¯ä»¥æµ‹é‡æ¯«ç§’çš„åˆ†æ•°(å–å†³äºæµè§ˆå™¨)ã€‚
2.  **æ›´å¥½çš„å¯é æ€§:**ç”¨æˆ·æˆ–æ“ä½œç³»ç»Ÿå¯ä»¥æ›´æ”¹ç³»ç»Ÿæ—¶é—´ï¼Œå› æ­¤åŸºäº`Date()`çš„æŒ‡æ ‡ä¸ä¼šæ€»æ˜¯å‡†ç¡®çš„ã€‚è¿™æ„å‘³ç€å½“æ—¶é’Ÿå‘å‰ç§»åŠ¨æ—¶ï¼Œä½ çš„åŠŸèƒ½ä¼šæ˜¾å¾—ç‰¹åˆ«æ…¢ï¼

`Date()`ç­‰ä»·äº [`performance.now()`](https://developer.mozilla.org/docs/Web/API/Performance/now) ï¼Œå®ƒè¿”å›ä¸€ä¸ªé«˜åˆ†è¾¨ç‡çš„æ—¶é—´æˆ³ï¼Œå½“è´Ÿè´£åˆ›å»ºæ–‡æ¡£çš„è¿›ç¨‹å¼€å§‹æ—¶(é¡µé¢å·²ç»åŠ è½½)ï¼Œè¯¥æ—¶é—´æˆ³è¢«è®¾ç½®ä¸ºé›¶:

```
const timeStart = performance.now();
runMyCode();
const timeTaken = performance.now() - timeStart;

console.log(`runMyCode() executed in ${ timeTaken }ms`);
```

éæ ‡å‡†çš„ [`performance.timeOrigin`](https://developer.mozilla.org/docs/Web/API/Performance/timeOrigin) å±æ€§ä¹Ÿå¯ä»¥è¿”å›ä» 1970 å¹´ 1 æœˆ 1 æ—¥å¼€å§‹çš„æ—¶é—´æˆ³ï¼Œå°½ç®¡è¿™åœ¨ IE å’Œ Deno ä¸­ä¸å¯ç”¨ã€‚

è¿›è¡Œå¤šæ¬¡æµ‹é‡æ—¶å˜å¾—ä¸åˆ‡å®é™…ã€‚æ€§èƒ½ API æä¾›äº†ä¸€ä¸ªç¼“å†²åŒºï¼Œæ‚¨å¯ä»¥é€šè¿‡å°†æ ‡ç­¾åç§°ä¼ é€’ç»™ [`performance.mark()`](https://developer.mozilla.org/docs/Web/API/Performance/mark) æ¥è®°å½•äº‹ä»¶ï¼Œä»¥ä¾›ä»¥ååˆ†æ:

```
performance.mark('start:app');
performance.mark('start:init');

init(); // run initialization functions

performance.mark('end:init');
performance.mark('start:funcX');

funcX(); // run another function

performance.mark('end:funcX');
performance.mark('end:app');
```

æ€§èƒ½ç¼“å†²åŒºä¸­æ‰€æœ‰æ ‡è®°å¯¹è±¡çš„æ•°ç»„å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æå–:

```
const mark = performance.getEntriesByType('mark');
```

ç¤ºä¾‹ç»“æœ:

```
[

  {
    detail: null
    duration: 0
    entryType: "mark"
    name: "start:app"
    startTime: 1000
  },
  {
    detail: null
    duration: 0
    entryType: "mark"
    name: "start:init"
    startTime: 1001
  },
  {
    detail: null
    duration: 0
    entryType: "mark"
    name: "end:init"
    startTime: 1100
  },
...
]
```

[`performance.measure()`](https://developer.mozilla.org/docs/Web/API/Performance/measure) æ–¹æ³•è®¡ç®—ä¸¤ä¸ªæ ‡è®°ä¹‹é—´çš„æ—¶é—´ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨æ€§èƒ½ç¼“å†²åŒºä¸­ã€‚ä¼ é€’ä¸€ä¸ªæ–°çš„åº¦é‡åã€èµ·å§‹æ ‡è®°å(æˆ– null è¡¨ç¤ºä»é¡µé¢åŠ è½½å¼€å§‹åº¦é‡)å’Œç»“æŸæ ‡è®°å(æˆ– null è¡¨ç¤ºåº¦é‡åˆ°å½“å‰æ—¶é—´):

```
performance.measure('init', 'start:init', 'end:init');
```

ä¸€ä¸ª [PerformanceMeasure å¯¹è±¡](https://developer.mozilla.org/docs/Web/API/PerformanceMeasure)è¢«é™„åŠ åˆ°å…·æœ‰è®¡ç®—å‡ºçš„æŒç»­æ—¶é—´çš„ç¼“å†²åŒºä¸­ã€‚è¦è·å¾—è¿™ä¸ªå€¼ï¼Œæ‚¨å¯ä»¥è¯·æ±‚ä¸€ä¸ªåŒ…å«æ‰€æœ‰åº¦é‡å€¼çš„æ•°ç»„:

```
const measure = performance.getEntriesByType('measure');
```

æˆ–æŒ‰åç§°è¯·æ±‚æµ‹é‡:

```
performance.getEntriesByName('init');
```

ç¤ºä¾‹ç»“æœ:

```
[
  {
    detail: null
    duration: 99
    entryType: "measure"
    name: "init"
    startTime: 1001
  }
]
```

### ä½¿ç”¨æ€§èƒ½ç¼“å†²åŒº

é™¤äº†æ ‡è®°å’Œåº¦é‡ï¼Œæ€§èƒ½ç¼“å†²åŒºè¿˜ç”¨äºè‡ªåŠ¨è®°å½•å¯¼èˆªæ—¶é—´ã€èµ„æºæ—¶é—´å’Œç»˜åˆ¶æ—¶é—´(æˆ‘ä»¬å°†åœ¨åé¢è®¨è®º)ã€‚æ‚¨å¯ä»¥è·å¾—ç¼“å†²åŒºä¸­æ‰€æœ‰æ¡ç›®çš„æ•°ç»„:

```
performance.getEntries();
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°æµè§ˆå™¨éƒ½æä¾›äº†ä¸€ä¸ªæœ€å¤šå¯ä»¥å­˜å‚¨ 150 ä¸ªèµ„æºæŒ‡æ ‡çš„ç¼“å†²åŒºã€‚å¯¹äºå¤§å¤šæ•°è¯„ä¼°ï¼Œè¿™åº”è¯¥è¶³å¤Ÿäº†ï¼Œä½†æ˜¯å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥å¢åŠ æˆ–å‡å°‘ç¼“å†²åŒºé™åˆ¶:

```
// record 500 metrics
performance.setResourceTimingBufferSize(500);
```

å¯ä»¥æŒ‰åç§°æ¸…é™¤æ ‡è®°ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªç©ºå€¼æ¥æ¸…é™¤æ‰€æœ‰æ ‡è®°:

 <dialog id="newsletter" class="dialog dialog has-dark-blue-background-color email-modal" aria-hidden="true">## æ³¨å†Œè®¢é˜…æ—¶äº‹é€šè®¯

<kinsta-form show-name="false" show-phone="false" show-website="false" show-company="false" show-disk-space="false" show-monthly-visits="false" show-number-of-websites="false" show-message="false" submit-button-text="Sign Up Now" submit-button-text-sending="Signing Up..." success-title="Thanks for subscribing!" success-message="Keep an eye out for our next newsletter." terms-template="newsletter" hubspot-source="subscribe_to_newsletter" submit-button-text-loading="Signing Up"></kinsta-form></dialog>

### æƒ³çŸ¥é“æˆ‘ä»¬æ˜¯æ€ä¹ˆè®©æµé‡å¢é•¿è¶…è¿‡ 1000%çš„å—ï¼Ÿ

åŠ å…¥ 20ï¼Œ000 å¤šåè·å¾—æˆ‘ä»¬æ¯å‘¨æ—¶äº‹é€šè®¯å’Œå†…éƒ¨æ¶ˆæ¯çš„äººçš„è¡Œåˆ—å§ï¼

[Subscribe Now](#newsletter)

```
performance.clearMarks('start:init');
```

ç±»ä¼¼åœ°ï¼Œå¯ä»¥é€šè¿‡åç§°æˆ–ç©ºå€¼æ¥æ¸…é™¤æ‰€æœ‰åº¦é‡:

```
performance.clearMeasures();
```

### ç›‘æ§æ€§èƒ½ç¼“å†²åŒºæ›´æ–°

ä¸€ä¸ª [**æ€§èƒ½è§‚å¯Ÿè€…**](https://developer.mozilla.org/docs/Web/API/PerformanceObserver) å¯ä»¥ç›‘æ§æ€§èƒ½ç¼“å†²åŒºçš„å˜åŒ–ï¼Œå¹¶åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœæ‚¨ä½¿ç”¨è¿‡ [**å˜å¼‚è§‚å¯Ÿå™¨**](https://developer.mozilla.org/docs/Web/API/MutationObserver) æ¥å“åº” DOM æ›´æ–°ï¼Œæˆ–è€…ä½¿ç”¨è¿‡ [**äº¤å‰è§‚å¯Ÿå™¨**](https://developer.mozilla.org/docs/Web/API/IntersectionObserver) æ¥æ£€æµ‹å…ƒç´ ä½•æ—¶è¢«æ»šåŠ¨åˆ°è§†å£ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯­æ³•åº”è¯¥å¾ˆç†Ÿæ‚‰ã€‚

æ‚¨å¿…é¡»ç”¨ä¸¤ä¸ªå‚æ•°å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…å‡½æ•°:

1.  å·²æ£€æµ‹åˆ°çš„è§‚å¯Ÿè€…æ¡ç›®çš„æ•°ç»„ï¼Œä»¥åŠ
2.  è§‚å¯Ÿè€…å¯¹è±¡ã€‚å¦‚æœ‰å¿…è¦ï¼Œå¯ä»¥è°ƒç”¨å…¶ [`disconnect()`](https://developer.mozilla.org/docs/Web/API/PerformanceObserver/disconnect) æ–¹æ³•æ¥åœæ­¢è§‚å¯Ÿå™¨ã€‚

```
function performanceCallback(list, observer) {

  list.getEntries().forEach(entry => {
    console.log(`name    : ${ entry.name }`);
    console.log(`type    : ${ entry.type }`);
    console.log(`start   : ${ entry.startTime }`);
    console.log(`duration: ${ entry.duration }`);
  });

}
```

è¯¥å‡½æ•°è¢«ä¼ é€’ç»™ä¸€ä¸ªæ–°çš„ PerformanceObserver å¯¹è±¡ã€‚å®ƒçš„ [`observe()`](https://developer.mozilla.org/docs/Web/API/PerformanceObserver/observe) æ–¹æ³•æ˜¯é€šè¿‡ä¸€ä¸ªæ€§èƒ½ç¼“å†²åŒº entryTypes æ•°ç»„æ¥è§‚å¯Ÿçš„:

```
let observer = new PerformanceObserver( performanceCallback );
observer.observe({ entryTypes: ['mark', 'measure'] });
```

åœ¨æœ¬ä¾‹ä¸­ï¼Œæ·»åŠ æ–°çš„æ ‡è®°æˆ–æµ‹é‡ä¼šè¿è¡Œ`performanceCallback()`åŠŸèƒ½ã€‚è™½ç„¶å®ƒåªåœ¨è¿™é‡Œè®°å½•æ¶ˆæ¯ï¼Œä½†å®ƒå¯ä»¥ç”¨æ¥è§¦å‘æ•°æ®ä¸Šä¼ æˆ–è¿›è¡Œè¿›ä¸€æ­¥çš„è®¡ç®—ã€‚

 <kinsta-advanced-cta language="en_US" type-int-post="128170" type-int-position="1">### æµ‹é‡æ²¹æ¼†æ€§èƒ½

Paint Timing API ä»…åœ¨å®¢æˆ·ç«¯ JavaScript ä¸­å¯ç”¨ï¼Œå¹¶è‡ªåŠ¨è®°å½•å¯¹[æ ¸å¿ƒ Web ç”Ÿå‘½å‘¨æœŸ](https://kinsta.com/blog/core-web-vitals/)å¾ˆé‡è¦çš„ä¸¤ä¸ªæŒ‡æ ‡:

1.  **first-paint:** æµè§ˆå™¨å·²ç»å¼€å§‹ç»˜åˆ¶é¡µé¢ã€‚
2.  **first-contentful-paint:** æµè§ˆå™¨å·²ç»ç»˜åˆ¶äº† DOM å†…å®¹çš„ç¬¬ä¸€ä¸ªé‡è¦é¡¹ç›®ï¼Œæ¯”å¦‚æ ‡é¢˜æˆ–å›¾åƒã€‚

è¿™äº›å¯ä»¥ä»æ€§èƒ½ç¼“å†²åŒºæå–åˆ°ä¸€ä¸ªæ•°ç»„ä¸­:

```
const paintTimes = performance.getEntriesByType('paint');
```

åœ¨é¡µé¢å®Œå…¨åŠ è½½ä¹‹å‰è¿è¡Œå®ƒè¦å°å¿ƒï¼›è¿™äº›å€¼å°†ä¸ä¼šå‡†å¤‡å¥½ã€‚è¦ä¹ˆç­‰å¾… [`window.load`](https://developer.mozilla.org/docs/Web/API/Window/load_event) äº‹ä»¶ï¼Œè¦ä¹ˆä½¿ç”¨ [`PerformanceObserver`](https://docs.google.com/document/d/1bO-CdqPOUVV0xaZkQMu5f5eHYxmV1RfoYVwPHXDRvyg/edit#heading=h.y0ea1dh8xmx) æ¥ç›‘æ§`paint`æ¡ç›®ç±»å‹ã€‚

Struggling with downtime and WordPress problems? Kinsta is the hosting solution designed to save you time! [Check out our features](https://kinsta.com/features/)

ç¤ºä¾‹ç»“æœ:

```
[
  {
    "name": "first-paint",
    "entryType": "paint",
    "startTime": 812,
    "duration": 0
  },
  {
    "name": "first-contentful-paint",
    "entryType": "paint",
    "startTime": 856,
    "duration": 0
  }
]
```

ç¬¬ä¸€æ¬¡ç»˜åˆ¶ç¼“æ…¢é€šå¸¸æ˜¯ç”±äº CSS æˆ– JavaScript çš„æ¸²æŸ“é˜»å¡é€ æˆçš„ã€‚å¦‚æœæµè§ˆå™¨ä¸å¾—ä¸ä¸‹è½½ä¸€ä¸ªå¤§çš„å›¾åƒæˆ–è€…[æ¸²æŸ“å¤æ‚çš„å…ƒç´ ](https://kinsta.com/blog/eliminate-render-blocking-javascript-css/)ï¼Œé‚£ä¹ˆä¸ç¬¬ä¸€æ¬¡ç»˜åˆ¶çš„å·®è·å¯èƒ½ä¼šå¾ˆå¤§ã€‚

## èµ„æºæ€§èƒ½æµ‹é‡

å›¾åƒã€æ ·å¼è¡¨å’Œ JavaScript æ–‡ä»¶ç­‰èµ„æºçš„ç½‘ç»œè®¡æ—¶ä¼šè‡ªåŠ¨è®°å½•åˆ°æ€§èƒ½ç¼“å†²åŒºä¸­ã€‚è™½ç„¶æ‚¨å¾ˆéš¾è§£å†³ç½‘ç»œé€Ÿåº¦é—®é¢˜(é™¤äº†å‡å°æ–‡ä»¶å¤§å°)ï¼Œä½†å®ƒå¯ä»¥å¸®åŠ©çªå‡ºè¾ƒå¤§èµ„äº§ã€ç¼“æ…¢çš„ Ajax å“åº”æˆ–è¡¨ç°ä¸ä½³çš„ç¬¬ä¸‰æ–¹è„šæœ¬çš„é—®é¢˜ã€‚

å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ä»ç¼“å†²åŒºä¸­æå–ä¸€ç»„[performance resource timing](https://developer.mozilla.org/docs/Web/API/PerformanceResourceTiming)æŒ‡æ ‡:

```
const resources = performance.getEntriesByType('resource');
```

æˆ–è€…ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¼ é€’èµ„äº§çš„å®Œæ•´ URL æ¥è·å–èµ„äº§çš„æŒ‡æ ‡:

```
const resource = performance.getEntriesByName('https://test.com/script.js');
```

ç¤ºä¾‹ç»“æœ:

```
[
  {
    connectEnd: 195,
    connectStart: 195,
    decodedBodySize: 0,
    domainLookupEnd: 195,
    domainLookupStart: 195,
    duration: 2,
    encodedBodySize: 0,
    entryType: "resource",
    fetchStart: 195,
    initiatorType: "script",
    name: "https://test.com/script.js",
    nextHopProtocol: "h3",
    redirectEnd: 0,
    redirectStart: 0,
    requestStart: 195,
    responseEnd: 197,
    responseStart: 197,
    secureConnectionStart: 195,
    serverTiming: [],
    startTime: 195,
    transferSize: 0,
    workerStart: 195
  }
]
```

å¯ä»¥æ£€æŸ¥ä»¥ä¸‹å±æ€§:

*   **åç§°**:èµ„æº URL
*   **æ¡ç›®ç±»å‹**:â€œèµ„æºâ€
*   **initiatorType** :èµ„æºæ˜¯å¦‚ä½•è¢«åˆå§‹åŒ–çš„ï¼Œå¦‚â€œè„šæœ¬â€æˆ–â€œé“¾æ¥â€
*   **serverTiming** :æœåŠ¡å™¨åœ¨ [HTTP Server-Timing header](https://developer.mozilla.org/docs/Web/HTTP/Headers/Server-Timing) ä¸­ä¼ é€’çš„ä¸€ç»„ [`PerformanceServerTiming`](https://developer.mozilla.org/docs/Web/API/PerformanceServerTiming) å¯¹è±¡(æ‚¨çš„æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºå¯ä»¥å°†æŒ‡æ ‡å‘é€ç»™å®¢æˆ·ç«¯è¿›è¡Œè¿›ä¸€æ­¥åˆ†æ)
*   **startTime** :è·å–å¼€å§‹æ—¶çš„æ—¶é—´æˆ³
*   **nextHopProtocol** :ä½¿ç”¨çš„ç½‘ç»œåè®®
*   **workerStart** :å¯åŠ¨æ¸è¿›å¼ Web App æœåŠ¡å·¥ä½œå™¨ä¹‹å‰çš„æ—¶é—´æˆ³(å¦‚æœè¯·æ±‚æœªè¢«æœåŠ¡å·¥ä½œå™¨æ‹¦æˆªï¼Œåˆ™ä¸º 0)
*   **redirectStart** :é‡å®šå‘å¼€å§‹æ—¶çš„æ—¶é—´æˆ³
*   **redirectEnd** :æœ€åä¸€ä¸ªé‡å®šå‘å“åº”çš„æœ€åä¸€ä¸ªå­—èŠ‚ä¹‹åçš„æ—¶é—´æˆ³
*   **fetchStart** :è·å–èµ„æºä¹‹å‰çš„æ—¶é—´æˆ³
*   **domain lookupstart**:DNS æŸ¥æ‰¾å‰çš„æ—¶é—´æˆ³
*   **domain lookupend**:DNS æŸ¥æ‰¾åçš„æ—¶é—´æˆ³
*   **connectStart** :å»ºç«‹æœåŠ¡å™¨è¿æ¥å‰çš„æ—¶é—´æˆ³
*   **connectEnd** :å»ºç«‹æœåŠ¡å™¨è¿æ¥åçš„æ—¶é—´æˆ³
*   **secureConnectionStart**:SSL æ¡æ‰‹ä¹‹å‰çš„æ—¶é—´æˆ³
*   **requestStart** :æµè§ˆå™¨è¯·æ±‚èµ„æºä¹‹å‰çš„æ—¶é—´æˆ³
*   **responseStart** :æµè§ˆå™¨æ”¶åˆ°ç¬¬ä¸€ä¸ªå­—èŠ‚æ•°æ®æ—¶çš„æ—¶é—´æˆ³
*   **responseEnd** :æ¥æ”¶åˆ°æœ€åä¸€ä¸ªå­—èŠ‚æˆ–å…³é—­è¿æ¥åçš„æ—¶é—´æˆ³
*   **æŒç»­æ—¶é—´**:start time å’Œ responseEnd ä¹‹å·®
*   **transferSize** :ä»¥å­—èŠ‚ä¸ºå•ä½çš„èµ„æºå¤§å°ï¼ŒåŒ…æ‹¬å¤´å’Œå‹ç¼©ä½“
*   **encodedBodySize** :è§£å‹ç¼©å‰çš„èµ„æºä½“ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½
*   **decodedBodySize** :è§£å‹ç¼©åçš„èµ„æºä½“ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½

è¿™ä¸ªç¤ºä¾‹è„šæœ¬æ£€ç´¢ç”± [Fetch API](https://developer.mozilla.org/docs/Web/API/Fetch_API) å‘èµ·çš„æ‰€æœ‰ Ajax è¯·æ±‚ï¼Œå¹¶è¿”å›æ€»ä¼ è¾“å¤§å°å’ŒæŒç»­æ—¶é—´:

```
const fetchAll = performance.getEntriesByType('resource')
  .filter( r => r.initiatorType === 'fetch')
  .reduce( (sum, current) => {
    return {
      transferSize: sum.transferSize += current.transferSize,
      duration: sum.duration += current.duration
    }
  },
  { transferSize: 0, duration: 0 }
);
```

## å¯¼èˆªæ€§èƒ½æµ‹é‡

å¸è½½å‰ä¸€é¡µå’ŒåŠ è½½å½“å‰é¡µçš„ç½‘ç»œæ—¶é—´ä¼šä½œä¸ºå•ä¸ª [`PerformanceNavigationTiming`](https://developer.mozilla.org/docs/Web/API/PerformanceNavigationTiming) å¯¹è±¡è‡ªåŠ¨è®°å½•åˆ°æ€§èƒ½ç¼“å†²åŒºã€‚

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†å…¶æå–åˆ°ä¸€ä¸ªæ•°ç»„ä¸­:

```
const pageTime = performance.getEntriesByType('navigation');
```

â€¦æˆ–è€…é€šè¿‡å°†é¡µé¢ URL ä¼ é€’ç»™`.getEntriesByName()`:

```
const pageTiming = performance.getEntriesByName(window.location);
```

è¿™äº›æŒ‡æ ‡ä¸[èµ„æº](https://docs.google.com/document/d/1bO-CdqPOUVV0xaZkQMu5f5eHYxmV1RfoYVwPHXDRvyg/edit#heading=h.k94hcflv9m3o)çš„æŒ‡æ ‡ç›¸åŒï¼Œä½†ä¹ŸåŒ…æ‹¬ç‰¹å®šäºé¡µé¢çš„å€¼:

*   **æ¡ç›®ç±»å‹**:å¦‚â€œå¯¼èˆªâ€
*   **ç±»å‹**:å¯ä»¥æ˜¯â€œå¯¼èˆªâ€ã€â€œé‡æ–°åŠ è½½â€ã€â€œåé€€ _ å‰è¿›â€æˆ–â€œé¢„å‘ˆç°â€
*   **é‡å®šå‘è®¡æ•°**:é‡å®šå‘æ¬¡æ•°
*   **unloadEventStart** :å‰ä¸€ä¸ªæ–‡æ¡£çš„å¸è½½äº‹ä»¶ä¹‹å‰çš„æ—¶é—´æˆ³
*   **unloadEventEnd** :å‰ä¸€ä¸ªæ–‡æ¡£å¸è½½äº‹ä»¶åçš„æ—¶é—´æˆ³
*   **domInteractive** :æµè§ˆå™¨è§£æ HTML å¹¶æ„å»º DOM æ—¶çš„æ—¶é—´æˆ³
*   **domContentLoadedEventStart**:æ–‡æ¡£çš„ DOMContentLoaded äº‹ä»¶è§¦å‘ä¹‹å‰çš„æ—¶é—´æˆ³
*   **domContentLoadedEventEnd** :æ–‡æ¡£çš„ DOMContentLoaded äº‹ä»¶å®Œæˆåçš„æ—¶é—´æˆ³
*   **DOM complete**:DOM æ„é€ å’Œ DOMContentLoaded äº‹ä»¶å®Œæˆåçš„æ—¶é—´æˆ³
*   **loadEventStart** :é¡µé¢åŠ è½½äº‹ä»¶è§¦å‘å‰çš„æ—¶é—´æˆ³
*   **loadEventEnd** :é¡µé¢åŠ è½½äº‹ä»¶åçš„æ—¶é—´æˆ³ï¼Œæ‰€æœ‰èµ„äº§å¯ç”¨

å…¸å‹é—®é¢˜åŒ…æ‹¬:

*   åœ¨**å¸è½½äº‹ä»¶ç»“æŸ**å’Œ**ä¸»äº’åŠ¨**ä¹‹é—´æœ‰å¾ˆé•¿çš„å»¶è¿Ÿã€‚è¿™å¯èƒ½è¡¨ç¤ºæœåŠ¡å™¨å“åº”ç¼“æ…¢ã€‚
*   åœ¨**domContentLoadedEventStart**å’Œ **domComplete** ä¹‹é—´æœ‰å¾ˆé•¿çš„å»¶è¿Ÿã€‚è¿™å¯èƒ½è¡¨æ˜é¡µé¢å¯åŠ¨è„šæœ¬å¤ªæ…¢ã€‚
*   åœ¨ **domComplete** å’Œ **loadEventEnd** ä¹‹é—´æœ‰å¾ˆé•¿çš„å»¶è¿Ÿã€‚è¿™å¯èƒ½è¡¨æ˜è¯¥é¡µé¢æœ‰å¤ªå¤šèµ„äº§ï¼Œæˆ–è€…æœ‰å‡ ä¸ªèµ„äº§åŠ è½½æ—¶é—´å¤ªé•¿ã€‚

## æ€§èƒ½è®°å½•å’Œåˆ†æ

Performance API å…è®¸æ‚¨æ•´ç†çœŸå®ä¸–ç•Œçš„ä½¿ç”¨æ•°æ®ï¼Œå¹¶å°†å…¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä»¥ä¾›è¿›ä¸€æ­¥åˆ†æã€‚ä½ *å¯ä»¥*ä½¿ç”¨[çš„ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå¦‚è°·æ­Œåˆ†æ](https://kinsta.com/blog/google-analytics-alternatives/)æ¥å­˜å‚¨æ•°æ®ï¼Œä½†ç¬¬ä¸‰æ–¹è„šæœ¬æœ‰å¯èƒ½è¢«é˜»æ­¢æˆ–å¼•å…¥æ–°çš„æ€§èƒ½é—®é¢˜ã€‚æ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å®šåˆ¶è‡ªå·±çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥ç¡®ä¿ç›‘æ§ä¸ä¼šå½±å“å…¶ä»–åŠŸèƒ½ã€‚

è­¦æƒ•æ— æ³•ç¡®å®šç»Ÿè®¡æ•°æ®çš„æƒ…å†µâ€”â€”å¯èƒ½æ˜¯å› ä¸ºç”¨æˆ·ä½¿ç”¨çš„æ˜¯æ—§æµè§ˆå™¨ï¼Œå±è”½äº† JavaScriptï¼Œæˆ–è€…åœ¨å…¬å¸ä»£ç†åé¢ã€‚äº†è§£ç¼ºå°‘å“ªäº›æ•°æ®æ¯”æ ¹æ®ä¸å®Œæ•´çš„ä¿¡æ¯åšå‡ºå‡è®¾æ›´æœ‰æˆæ•ˆã€‚

ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨çš„åˆ†æè„šæœ¬ä¸ä¼šå› ä¸ºè¿è¡Œå¤æ‚çš„è®¡ç®—æˆ–ä¸Šä¼ å¤§é‡æ•°æ®è€Œå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚è€ƒè™‘åˆ©ç”¨ web workers å¹¶å°½é‡å‡å°‘åŒæ­¥ localStorage è°ƒç”¨çš„ä½¿ç”¨ã€‚ä»¥åæ€»æ˜¯å¯ä»¥æ‰¹é‡å¤„ç†åŸå§‹æ•°æ®çš„ã€‚

æœ€åï¼Œè¦è­¦æƒ•å¼‚å¸¸å€¼ï¼Œä¾‹å¦‚ä¼šå¯¹ç»Ÿè®¡æ•°æ®äº§ç”Ÿè´Ÿé¢å½±å“çš„éå¸¸å¿«æˆ–éå¸¸æ…¢çš„è®¾å¤‡å’Œè¿æ¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¹ä¸ªç”¨æˆ·åœ¨ä¸¤ç§’é’Ÿå†…åŠ è½½ä¸€ä¸ªé¡µé¢ï¼Œä½†æ˜¯ç¬¬åä¸ªç”¨æˆ·ç»å†äº† 60 ç§’çš„ä¸‹è½½ï¼Œé‚£ä¹ˆå¹³å‡å»¶è¿Ÿæ¥è¿‘ 8 ç§’ã€‚æ›´ç°å®çš„æŒ‡æ ‡æ˜¯ä¸­é—´å€¼(2 ç§’)æˆ–ç¬¬ 90 ä¸ªç™¾åˆ†ä½æ•°(æ¯ 10 ä¸ªç”¨æˆ·ä¸­æœ‰ 9 ä¸ªç”¨æˆ·çš„åŠ è½½æ—¶é—´ä¸è¶…è¿‡ 2 ç§’)ã€‚

 <kinsta-advanced-cta language="en_US" type-int-post="128170" type-int-position="2">## æ‘˜è¦

å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œç½‘é¡µæ€§èƒ½ä»ç„¶æ˜¯ä¸€ä¸ªå…³é”®çš„ T2 å› ç´ ã€‚ç”¨æˆ·å¸Œæœ›ç½‘ç«™å’Œåº”ç”¨ç¨‹åºèƒ½å¤Ÿåœ¨å¤§å¤šæ•°è®¾å¤‡ä¸Šå“åº”ã€‚æœç´¢å¼•æ“ä¼˜åŒ–ä¹Ÿä¼šå—åˆ°å½±å“ï¼Œå› ä¸º[é€Ÿåº¦è¾ƒæ…¢çš„ç½‘ç«™åœ¨è°·æ­Œ](https://kinsta.com/blog/core-web-vitals/)ä¸­è¢«é™çº§ã€‚
[å¼€å§‹ä½¿ç”¨æ€§èƒ½ API æ‰€éœ€çš„ä¸€åˆ‡éƒ½åœ¨è¿™é‡ŒğŸ’ª ç‚¹å‡»æ¨æ–‡](https://twitter.com/intent/tweet?url=https%3A%2F%2Fbit.ly%2F3dl8OA3&via=kinsta&text=Everything+you+need+to+know+to+get+started+with+the+Performance+API+is+right+here+%F0%9F%92%AA&hashtags=API%2CWebDev)
ç°åœ¨æœ‰å¾ˆå¤š[æ€§èƒ½ç›‘æ§å·¥å…·](https://kinsta.com/blog/application-performance-monitoring/)ï¼Œä½†æ˜¯å¤§å¤šæ•°è¯„ä¼°æœåŠ¡å™¨ç«¯æ‰§è¡Œé€Ÿåº¦æˆ–è€…ä½¿ç”¨æœ‰é™æ•°é‡çš„æœ‰èƒ½åŠ›çš„å®¢æˆ·ç«¯æ¥åˆ¤æ–­æµè§ˆå™¨æ¸²æŸ“ã€‚Performance API æä¾›äº†ä¸€ç§æ•´ç†çœŸå®ç”¨æˆ·æŒ‡æ ‡çš„æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¸å¯èƒ½é€šè¿‡å…¶ä»–æ–¹æ³•æ¥è®¡ç®—ã€‚

* * *

è®©ä½ æ‰€æœ‰çš„[åº”ç”¨ç¨‹åº](https://kinsta.com/application-hosting/)ã€[æ•°æ®åº“](https://kinsta.com/database-hosting/)å’Œ [WordPress ç½‘ç«™](https://kinsta.com/wordpress-hosting/)åœ¨çº¿å¹¶åœ¨ä¸€ä¸ªå±‹æªä¸‹ã€‚æˆ‘ä»¬åŠŸèƒ½ä¸°å¯Œçš„é«˜æ€§èƒ½äº‘å¹³å°åŒ…æ‹¬:

*   åœ¨ MyKinsta ä»ªè¡¨ç›˜ä¸­è½»æ¾è®¾ç½®å’Œç®¡ç†
*   24/7 ä¸“å®¶æ”¯æŒ
*   æœ€å¥½çš„è°·æ­Œäº‘å¹³å°ç¡¬ä»¶å’Œç½‘ç»œï¼Œç”± Kubernetes æä¾›æœ€å¤§çš„å¯æ‰©å±•æ€§
*   é¢å‘é€Ÿåº¦å’Œå®‰å…¨æ€§çš„ä¼ä¸šçº§ Cloudflare é›†æˆ
*   å…¨çƒå—ä¼—è¦†ç›–å…¨çƒå¤šè¾¾ 35 ä¸ªæ•°æ®ä¸­å¿ƒå’Œ 275 å¤šä¸ª pop

åœ¨ç¬¬ä¸€ä¸ªæœˆä½¿ç”¨æ‰˜ç®¡çš„[åº”ç”¨ç¨‹åºæˆ–æ‰˜ç®¡](https://kinsta.com/application-hosting/)çš„[æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥äº«å— 20 ç¾å…ƒçš„ä¼˜æƒ ï¼Œäº²è‡ªæµ‹è¯•ä¸€ä¸‹ã€‚æ¢ç´¢æˆ‘ä»¬çš„](https://kinsta.com/database-hosting/)[è®¡åˆ’](https://kinsta.com/plans/)æˆ–[ä¸é”€å”®äººå‘˜äº¤è°ˆ](https://kinsta.com/contact-us/)ä»¥æ‰¾åˆ°æœ€é€‚åˆæ‚¨çš„æ–¹å¼ã€‚</kinsta-advanced-cta></kinsta-advanced-cta></kinsta-advanced-cta></kinsta-auto-toc>
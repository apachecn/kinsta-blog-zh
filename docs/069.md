# å¦‚ä½•ä¸ºå¤è…¾å ¡åˆ›å»ºåŠ¨æ€å—

> åŸæ–‡ï¼š<https://kinsta.com/blog/dynamic-blocks/>

ä½ è¿˜åœ¨è¢«[å¤è…¾å ¡](https://kinsta.com/blog/gutenberg-wordpress-editor/)è¿·æƒ‘å—ï¼Ÿæˆ–è€…ä½ æ˜¯é‚£äº›åšä¿¡å—ç¼–è¾‘å™¨æ½œåŠ›çš„äººä¹‹ä¸€ï¼Œå¹¶æƒ³çŸ¥é“ä½¿ç”¨å—ç¼–è¾‘å™¨èƒ½æŠŠä»–ä»¬çš„åˆ›é€ åŠ›æ¨è¿›åˆ°ä»€ä¹ˆç¨‹åº¦ï¼Ÿ

æ— è®ºä½ å±äºå“ªä¸€ç±»ç”¨æˆ·ï¼ŒGutenberg éƒ½åœ¨è¿™é‡Œï¼Œè¿™ç¯‡æ–‡ç« å°†ä¼šç»™ä½ ä¸€ä¸ªæ·±å…¥çš„æ¦‚è¿°ï¼Œä»‹ç» WordPress block editor å¹•åå‘ç”Ÿçš„äº‹æƒ…ã€‚ä½†è¿™è¿˜ä¸æ˜¯å…¨éƒ¨ï¼

ç»§[æˆ‘ä»¬ä¹‹å‰çš„æ•™ç¨‹](https://kinsta.com/blog/gutenberg-blocks/)æä¾›äº† Gutenberg å—å¼€å‘çš„ä¸€èˆ¬ä»‹ç»ä¹‹åï¼Œæœ¬æ–‡è¶…è¶Šäº†åŸºç¡€ï¼Œä»‹ç»äº†æ›´é«˜çº§çš„å—ç±»å‹ã€‚è¿™äº›å—è¢«ç§°ä¸ºåŠ¨æ€å—ã€‚

ä»Šå¤©ï¼Œæ‚¨å°†å­¦ä¹ ä»€ä¹ˆæ˜¯åŠ¨æ€å—ï¼Œå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠä»å¤´å¼€å§‹åˆ›å»ºåŠ¨æ€å—æ‰€éœ€çš„æ‰€æœ‰çŸ¥è¯†ã€‚

é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯å¤è…¾å ¡åŠ¨æ€å—ï¼Œ[é™æ€](https://kinsta.com/blog/gutenberg-blocks/)å’ŒåŠ¨æ€å—çš„å…³é”®åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

## ä»€ä¹ˆæ˜¯åŠ¨æ€å—ï¼Ÿä¸€ä¸ªä¾‹å­

ä½¿ç”¨é™æ€å—æ—¶ï¼Œå†…å®¹æ˜¯ç”±ç”¨æˆ·åœ¨ç¼–è¾‘å¸–å­æˆ–é¡µé¢æ—¶æ‰‹åŠ¨æ·»åŠ çš„ï¼Œè€Œä½¿ç”¨åŠ¨æ€å—æ—¶ï¼Œå†…å®¹æ˜¯åœ¨é¡µé¢åŠ è½½æ—¶åŠ¨æ€åŠ è½½å’Œå¤„ç†çš„ã€‚å¯¹äºåŠ¨æ€å—ï¼Œä»æ•°æ®åº“ä¸­æå–å—å†…å®¹ï¼Œå¹¶æŒ‰åŸæ ·æ˜¾ç¤ºæˆ–æ˜¾ç¤ºä»»ä½•ç±»å‹çš„æ•°æ®æ“ä½œçš„ç»“æœã€‚

è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ã€‚å‡è®¾æ‚¨æƒ³è¦åˆ›å»ºä¸€ç»„åµŒå¥—å—ï¼Œæ˜¾ç¤ºæ–‡ç« ä½œè€…çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶é€‰æ‹©åŒä¸€ä½œè€…çš„æœ€æ–°æ–‡ç« ã€‚





> Kinsta æŠŠæˆ‘å® åäº†ï¼Œæ‰€ä»¥æˆ‘ç°åœ¨è¦æ±‚æ¯ä¸ªä¾›åº”å•†éƒ½æä¾›è¿™æ ·çš„æœåŠ¡ã€‚æˆ‘ä»¬è¿˜è¯•å›¾é€šè¿‡æˆ‘ä»¬çš„ SaaS å·¥å…·æ”¯æŒè¾¾åˆ°è¿™ä¸€æ°´å¹³ã€‚
> 
> <footer class="wp-block-kinsta-client-quote__footer">
> 
> ![](img/60f15faa5735bd2437bf9dada5ee9192.png)
> 
> <cite class="wp-block-kinsta-client-quote__cite">Suganthan Mohanadasan from @Suganthanmn</cite></footer>

[View plans](https://kinsta.com/plans/)

![A Group block including Post Author and Latest Posts](img/d6755ee698ccb29df30f9252b9d21b84.png)

A Group block including Post Author and Latest Posts



ä½œä¸º Gutenberg ç”¨æˆ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å—:

*   **æ ‡é¢˜**æ ¸å¿ƒå—
*   **å¸–å­ä½œè€…**æ ¸å¿ƒå—
*   **æœ€æ–°å¸–å­**æ ¸å¿ƒåŒºå—

æ‚¨è¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒ…å«è¿™äº›å—çš„ç»„ï¼Œå¹¶å°†è¯¥ç»„æ·»åŠ åˆ°å¯é‡ç”¨å—ä¸­ä»¥ä¾›å°†æ¥ä½¿ç”¨ã€‚

![Adding a group block to reusable blocks](img/ed358b9cabac658a8dbf138229b24589.png)

Adding a group block to reusable blocks



å¾ˆç®€å•ï¼Œä¸æ˜¯å—ï¼Ÿæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªåŠ¨æ€å—ï¼Œå¹¶å°†å…¶å¿«é€Ÿæ·»åŠ åˆ°æ‚¨çš„å¸–å­å’Œé¡µé¢ä¸­ã€‚

æˆªæ­¢åˆ°[WordPress 5.9](https://kinsta.com/blog/wordpress-5-9/),[åŒºå—ç¼–è¾‘å™¨](https://kinsta.com/blog/gutenberg-wordpress-editor/)æä¾›äº†è¶…è¿‡ 90 ç§ä¸åŒçš„åŒºå—ï¼Œä½ å¾ˆæœ‰å¯èƒ½å¼€ç®±å°±èƒ½æ‰¾åˆ°é€‚åˆä½ çš„åŒºå—ã€‚å¦‚æœä½ éœ€è¦æ›´å¤šï¼Œåœ¨ WordPress æ’ä»¶ç›®å½•ä¸­å¿«é€Ÿæœç´¢ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šå…è´¹æ’ä»¶æä¾›äº†[é¢å¤–çš„æ¨¡å—](https://wordpress.org/plugins/search/gutenberg/)ã€‚

ä½†æ˜¯å¦‚æœä½ æ˜¯ä¸€å WordPress å¼€å‘è€…â€”â€”æˆ–è€…ä½ æ­£è®¡åˆ’æˆä¸ºä¸€å WordPress å¼€å‘è€…å‘¢ï¼Ÿä¹Ÿè®¸ä½ æœ‰éå¸¸å…·ä½“çš„éœ€æ±‚ï¼Œä½†æ‰¾ä¸åˆ°ä½ æ­£åœ¨å¯»æ‰¾çš„åŒºå—ï¼Œæˆ–è€…ä½ åªæ˜¯æƒ³è·å¾—æ–°çš„ä¸“ä¸šæŠ€èƒ½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½éœ€è¦å­¦ä¹ å¦‚ä½•åˆ›å»ºåŠ¨æ€å—ã€‚

[å‡†å¤‡å¥½æŠŠä½ çš„ WordPress å¼€å‘è€…ç”Ÿæ¶¯å¸¦ä¸Šæœˆçƒäº†å—ï¼ŸğŸš€ğŸŒ™ä»è¿™æœ¬å¤§è§„æ¨¡çš„åŠ¨æ€å—å¼€å‘æŒ‡å—å¼€å§‹å§ï¼ğŸ‘©â€ğŸš€ ç‚¹å‡»æ¨æ–‡](https://twitter.com/intent/tweet?url=https%3A%2F%2Fbit.ly%2F3zS8lhf&via=kinsta&text=Ready+to+take+your+career+as+WordPress+developer+to+the+moon%3F+%F0%9F%9A%80%F0%9F%8C%99+Start+with+this+massive+guide+to+dynamic+block+development%21+%F0%9F%91%A9%E2%80%8D%F0%9F%9A%80&hashtags=Gutenberg%2CDevelopment)


## ä»å¼€å‘äººå‘˜çš„è§’åº¦çœ‹å¤è…¾å ¡åŠ¨æ€å—

[åŠ¨æ€å—](https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/creating-dynamic-blocks/)æœ‰ä¸¤ä¸ªä¸»è¦ç”¨ä¾‹ã€‚

ç¬¬ä¸€ä¸ªç”¨ä¾‹æ˜¯ï¼Œå½“åŒ…å«å—çš„é¡µé¢å°šæœªæ›´æ–°æ—¶ï¼Œæ‚¨éœ€è¦æ›´æ–°å—çš„å†…å®¹ã€‚ä¾‹å¦‚ï¼Œå½“å—åŒ…å«æœ€æ–°å¸–å­æˆ–è¯„è®ºçš„åˆ—è¡¨æ—¶ï¼Œä»¥åŠé€šå¸¸å½“å—çš„å†…å®¹æ˜¯ä½¿ç”¨ä»æ•°æ®åº“ä¸­æ£€ç´¢çš„æ•°æ®åŠ¨æ€ç”Ÿæˆæ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚

![Adding a Query Loop block](img/3cde78065de780cf5069f68c4bc72fc1.png)

Adding a Query Loop block



ç¬¬äºŒä¸ªç”¨ä¾‹æ˜¯å—ä»£ç çš„æ›´æ–°éœ€è¦ç«‹å³æ˜¾ç¤ºåœ¨å‰ç«¯ã€‚ä½¿ç”¨åŠ¨æ€å—è€Œä¸æ˜¯é™æ€å—ä¼šå¯¼è‡´æ›´æ”¹ç«‹å³åº”ç”¨äºå—çš„æ‰€æœ‰å¼•ç”¨ã€‚

å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ æ”¹å˜ä¸€ä¸ªé™æ€å—äº§ç”Ÿçš„ HTMLï¼Œç”¨æˆ·å°†ä¼šçœ‹åˆ°ä¸€ä¸ª[æ— æ•ˆå¯¹è¯æ¡†](https://developer.wordpress.org/block-editor/reference-guides/block-api/block-edit-save/#validation)ï¼Œç›´åˆ°è¯¥å—çš„å‰ä¸€ç‰ˆæœ¬çš„æ¯ä¸ªå®ä¾‹éƒ½è¢«åˆ é™¤å¹¶ç”¨æ–°ç‰ˆæœ¬æ›¿æ¢ï¼Œæˆ–è€…ä½ å°†æ—§ç‰ˆæœ¬æ ‡è®°ä¸ºä¸æ¨èä½¿ç”¨(å‚è§[ä¸æ¨èä½¿ç”¨](https://developer.wordpress.org/block-editor/reference-guides/block-api/block-deprecation/)å’Œ[å—éªŒè¯ã€ä¸æ¨èä½¿ç”¨å’Œè¿ç§»ä½“éªŒ](https://github.com/WordPress/gutenberg/issues/7604))ã€‚

![Unexpected or invalid content.](img/79fc2c78becfbd1f5fdefc5934206964.png)

Unexpected or invalid content.



ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å¼€å§‹æ„å»ºåŠ¨æ€å—ä¹‹å‰ï¼Œæ‚¨éœ€è¦ç†è§£ä¸€äº›æ¦‚å¿µã€‚

### åº”ç”¨ç¨‹åºçŠ¶æ€å’Œæ•°æ®å­˜å‚¨

[å¤è…¾å ¡æ˜¯ä¸€ä¸ª React SPA åº”ç”¨](https://kinsta.com/blog/gutenberg-blocks/#what-is-a-gutenberg-block)ï¼Œå¤è…¾å ¡é‡Œçš„ä¸€åˆ‡éƒ½æ˜¯ React ç»„ä»¶ã€‚ç¼–è¾‘å™¨ä¸­çš„æ–‡ç« æ ‡é¢˜ã€æ ‡é¢˜ã€æ®µè½ã€å›¾åƒå’Œä»»ä½• HTML å†…å®¹å—éƒ½æ˜¯ä¸€ä¸ª React ç»„ä»¶ï¼Œè¿˜æœ‰ä¾§è¾¹æ å’Œå—å·¥å…·æ æ§ä»¶ã€‚

åœ¨æˆ‘ä»¬ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åªä½¿ç”¨å±æ€§æ¥å­˜å‚¨æ•°æ®ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è¿›ä¸€æ­¥å¼•å…¥**çŠ¶æ€**çš„æ¦‚å¿µã€‚

ç®€å•åœ°è¯´ï¼Œ`state`å¯¹è±¡æ˜¯[ï¼Œä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡](https://www.w3schools.com/react/react_state.asp)ï¼Œç”¨äºåŒ…å«å…³äºç»„ä»¶çš„ä¿¡æ¯ã€‚ç»„ä»¶çš„`state`å¯ä»¥éšæ—¶é—´æ”¹å˜ï¼Œä»»ä½•æ—¶å€™æ”¹å˜ï¼Œç»„ä»¶éƒ½ä¼šé‡æ–°å‘ˆç°ã€‚

ç±»ä¼¼äº`state`å¯¹è±¡ï¼Œå±æ€§æ˜¯ç”¨æ¥ä¿å­˜ç»„ä»¶ä¿¡æ¯çš„æ™®é€š JavaScript å¯¹è±¡ã€‚ä½†æ˜¯[å’Œ`state`ä¹‹é—´æœ‰ä¸€ä¸ªå…³é”®çš„åŒºåˆ«](https://reactjs.org/docs/faq-state.html#what-is-the-difference-between-state-and-props):

> `props`ä¼ é€’ç»™ç»„ä»¶(ç±»ä¼¼äºå‡½æ•°å‚æ•°)ï¼Œè€Œ`state`åœ¨ç»„ä»¶å†…ç®¡ç†(ç±»ä¼¼äºå‡½æ•°å†…å£°æ˜çš„å˜é‡)ã€‚

æ‚¨å¯èƒ½è®¤ä¸ºçŠ¶æ€æ˜¯åœ¨ç»™å®šæ—¶é—´ç‚¹è·å–çš„æ•°æ®å¿«ç…§ï¼Œåº”ç”¨ç¨‹åºå­˜å‚¨è¿™äº›æ•°æ®ä»¥æ§åˆ¶ç»„ä»¶çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå¦‚æœå—ç¼–è¾‘å™¨è®¾ç½®ä¾§æ æ‰“å¼€ï¼Œä¸€æ¡ä¿¡æ¯å°†å­˜å‚¨åœ¨`state`å¯¹è±¡çš„æŸå¤„ã€‚

å½“ä¿¡æ¯åœ¨å•ä¸ªç»„ä»¶å†…å…±äº«æ—¶ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º**æœ¬åœ°çŠ¶æ€**ã€‚å½“ä¿¡æ¯åœ¨åº”ç”¨ç¨‹åºå†…çš„ç»„ä»¶é—´å…±äº«æ—¶ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º**åº”ç”¨ç¨‹åºçŠ¶æ€**ã€‚

åº”ç”¨ç¨‹åºçŠ¶æ€ä¸å­˜å‚¨çš„æ¦‚å¿µå¯†åˆ‡ç›¸å…³ã€‚æ ¹æ® [Redux æ–‡æ¡£](https://redux.js.org/api/store):

> ä¸€ä¸ªå­˜å‚¨ä¿å­˜äº†ä½ çš„åº”ç”¨ç¨‹åºçš„æ•´ä¸ªçŠ¶æ€æ ‘ã€‚æ”¹å˜å®ƒå†…éƒ¨çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯åœ¨å®ƒä¸Šé¢åˆ†æ´¾ä¸€ä¸ª[åŠ¨ä½œ](https://redux.js.org/understanding/thinking-in-redux/glossary#action)ã€‚

å› æ­¤ï¼ŒRedux å°†åº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åœ¨ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡æ ‘ä¸­(å³å­˜å‚¨)ã€‚åªèƒ½é€šè¿‡ä½¿ç”¨[åŠ¨ä½œ](https://redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers#designing-actions)å’Œ[å‡å°‘å™¨](https://redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers#writing-reducers)åˆ›å»ºæ–°å¯¹è±¡æ¥æ”¹å˜å¯¹è±¡æ ‘ã€‚

åœ¨ WordPress ä¸­ï¼Œå•†åº—ç”± **WordPress æ•°æ®æ¨¡å—**ç®¡ç†ã€‚

### å¤è…¾å ¡çš„æ¨¡å—åŒ–ã€åŒ…å’Œæ•°æ®å­˜å‚¨

å¤è…¾å ¡çŸ¥è¯†åº“æ˜¯åœ¨å‡ ä¸ª**å¯é‡ç”¨å’Œç‹¬ç«‹çš„æ¨¡å—**ä¸Šä»å¤´å¼€å§‹æ„å»ºçš„ï¼Œè¿™äº›æ¨¡å—ç»„åˆåœ¨ä¸€èµ·ï¼Œæ„å»ºäº†ç¼–è¾‘ç•Œé¢ã€‚è¿™äº›æ¨¡å—ä¹Ÿè¢«ç§°ä¸º**åŒ…**ã€‚

å®˜æ–¹æ–‡æ¡£åˆ—å‡ºäº†ä¸¤ç§ä¸åŒçš„[åŒ…](https://developer.wordpress.org/block-editor/explanations/architecture/modularity/#types-of-packages):

*   **ç”Ÿäº§åŒ…**ç»„æˆäº†åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„ç”Ÿäº§ä»£ç ã€‚WordPress ä¸­æœ‰ä¸¤ç§ç±»å‹çš„äº§å“åŒ…:
    *   **å¸¦æœ‰æ ·å¼è¡¨çš„åŒ…**æä¾›æ ·å¼è¡¨ä»¥æ­£å¸¸è¿è¡Œã€‚
    *   **å¸¦æœ‰æ•°æ®å­˜å‚¨çš„åŒ…**å®šä¹‰æ•°æ®å­˜å‚¨æ¥å¤„ç†å®ƒä»¬çš„çŠ¶æ€ã€‚[å¸¦æœ‰æ•°æ®å­˜å‚¨çš„åŒ…](https://developer.wordpress.org/block-editor/explanations/architecture/modularity/#packages-with-data-stores)å¯ä»¥è¢«ç¬¬ä¸‰æ–¹æ’ä»¶å’Œä¸»é¢˜ç”¨æ¥æ£€ç´¢å’Œæ“ä½œæ•°æ®ã€‚
*   **å¼€å‘åŒ…**ç”¨äºå¼€å‘æ¨¡å¼ã€‚è¿™äº›åŒ…åŒ…æ‹¬æ—æŒºã€æµ‹è¯•ã€æ„å»ºç­‰å·¥å…·ã€‚

è¿™é‡Œæˆ‘ä»¬æœ€æ„Ÿå…´è¶£çš„æ˜¯å¸¦æœ‰æ•°æ®å­˜å‚¨åº“çš„[åŒ…ï¼Œç”¨äºæ£€ç´¢å’Œæ“ä½œæ•°æ®ã€‚](https://developer.wordpress.org/block-editor/explanations/architecture/modularity/#packages-with-data-stores)

### WordPress æ•°æ®ä»“åº“

WordPress æ•°æ®æ¨¡å—å»ºç«‹åœ¨ [Redux](https://redux.js.org/) çš„åŸºç¡€ä¸Šï¼Œå¹¶åˆ†äº«äº†[çš„ä¸‰ä¸ª Redux æ ¸å¿ƒåŸåˆ™](https://redux.js.org/understanding/thinking-in-redux/three-principles)ï¼Œå°½ç®¡ä¸[æœ‰ä¸€äº›å…³é”®çš„ä¸åŒ](https://github.com/WordPress/gutenberg/blob/e9994b49786570391b5690b85bd1f1fd78de845e/packages/data/README.md#comparison-with-redux)ã€‚



### ä¿¡æ¯

Redux æ˜¯ JavaScript åº”ç”¨ç¨‹åºçš„çŠ¶æ€ç®¡ç†å™¨ã€‚[ä¸‰ä¸ªåŸºæœ¬åŸåˆ™](https://redux.js.org/understanding/thinking-in-redux/three-principles)æ€»ç»“äº† Redux çš„å·¥ä½œæ–¹å¼:

*   **çœŸå®çš„å•ä¸€æ¥æº**:ä½ çš„åº”ç”¨ç¨‹åºçš„[å…¨å±€çŠ¶æ€](https://redux.js.org/understanding/thinking-in-redux/glossary#state)å­˜å‚¨åœ¨ä¸€ä¸ªå•ä¸€å­˜å‚¨çš„å¯¹è±¡æ ‘ä¸­ã€‚
*   **çŠ¶æ€æ˜¯åªè¯»çš„**:æ”¹å˜çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯å‘å‡ºä¸€ä¸ªåŠ¨ä½œï¼Œä¸€ä¸ªæè¿°å‘ç”Ÿäº†ä»€ä¹ˆçš„å¯¹è±¡ã€‚
*   **ç”¨çº¯å‡½æ•°è¿›è¡Œæ”¹å˜**:ä¸ºäº†æŒ‡å®šçŠ¶æ€æ ‘å¦‚ä½•è¢«åŠ¨ä½œè½¬æ¢ï¼Œä½ è¦ç¼–å†™çº¯ reducersã€‚



å®˜æ–¹æ–‡ä»¶æä¾›äº†[çš„å¦‚ä¸‹å®šä¹‰](https://github.com/WordPress/gutenberg/blob/e9994b49786570391b5690b85bd1f1fd78de845e/packages/data/README.md):

> WordPress çš„æ•°æ®æ¨¡å—ä½œä¸ºç®¡ç†æ’ä»¶å’Œ WordPress è‡ªèº«åº”ç”¨ç¨‹åºçŠ¶æ€çš„ä¸­å¿ƒï¼Œæä¾›ç®¡ç†ä¸åŒæ¨¡å—å†…éƒ¨å’Œä¹‹é—´æ•°æ®çš„å·¥å…·ã€‚å®ƒè¢«è®¾è®¡æˆä¸€ç§ç»„ç»‡å’Œå…±äº«æ•°æ®çš„æ¨¡å—åŒ–æ¨¡å¼:ç®€å•åˆ°è¶³ä»¥æ»¡è¶³ä¸€ä¸ªå°æ’ä»¶çš„éœ€æ±‚ï¼ŒåŒæ—¶å¯æ‰©å±•åˆ°æ»¡è¶³ä¸€ä¸ªå¤æ‚çš„å•é¡µé¢åº”ç”¨ç¨‹åºçš„éœ€æ±‚ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼ŒGutenberg åœ¨åº”ç”¨ç¨‹åºçŠ¶æ€ä¸­æ³¨å†Œäº†å‡ ä¸ªæ•°æ®å­˜å‚¨åº“ã€‚è¿™äº›å•†åº—éƒ½æœ‰ç‰¹å®šçš„åç§°å’Œç”¨é€”:

*   `core` : [WordPress æ ¸å¿ƒæ•°æ®](https://github.com/WordPress/gutenberg/tree/trunk/packages/core-data)
*   `core/annotations` : [æ³¨è§£](https://github.com/WordPress/gutenberg/tree/trunk/packages/annotations)
*   `core/blocks` : [å—ç±»å‹æ•°æ®](https://github.com/WordPress/gutenberg/tree/trunk/packages/blocks)
*   `core/block-editor` : [å—ç¼–è¾‘çš„æ•°æ®](https://github.com/WordPress/gutenberg/tree/trunk/packages/block-editor)
*   `core/editor` : [å¸–å­ç¼–è¾‘çš„æ•°æ®](https://github.com/WordPress/gutenberg/tree/trunk/packages/editor)
*   `core/edit-post` : [ç¼–è¾‘çš„ UI æ•°æ®](https://github.com/WordPress/gutenberg/tree/trunk/packages/edit-post)
*   `core/notices` : [é€šçŸ¥æ•°æ®](https://github.com/WordPress/gutenberg/tree/trunk/packages/notices)
*   `core/nux`:[NUX(æ–°ç”¨æˆ·ä½“éªŒ)æ•°æ®](https://github.com/WordPress/gutenberg/tree/trunk/packages/nux)
*   `core/viewport` : [è§†å£æ•°æ®](https://github.com/WordPress/gutenberg/tree/trunk/packages/viewport)

é€šè¿‡è¿™äº›å•†åº—ï¼Œæ‚¨å°†èƒ½å¤Ÿè®¿é—®ä¸€å¤§å †æ•°æ®:

1.  **ä¸å½“å‰å¸–å­**ç›¸å…³çš„æ•°æ®ï¼Œå¦‚å¸–å­æ ‡é¢˜ã€æ‘˜å½•ã€ç±»åˆ«å’Œæ ‡ç­¾ã€åŒºå—ç­‰ã€‚
2.  **ä¸ç”¨æˆ·ç•Œé¢**ç›¸å…³çš„æ•°æ®ï¼Œå³å¼€å…³æ˜¯å¦æ‰“å¼€ã€‚
3.  **ä¸æ•´ä¸ª WordPress å®‰è£…ç›¸å…³çš„æ•°æ®**ï¼Œä¾‹å¦‚æ³¨å†Œçš„åˆ†ç±»æ³•ã€æ–‡ç« ç±»å‹ã€åšå®¢æ ‡é¢˜ã€ä½œè€…ç­‰ã€‚

è¿™äº›å•†åº—ä½äºå…¨å±€`wp`å¯¹è±¡ä¸­ã€‚è¦è®¿é—®å•†åº—çš„çŠ¶æ€ï¼Œæ‚¨å°†ä½¿ç”¨`select`å‡½æ•°ã€‚

è¦äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¸–å­æˆ–é¡µé¢ï¼Œå¹¶å¯åŠ¨æ‚¨çš„[æµè§ˆå™¨çš„æ£€æŸ¥å™¨](https://kinsta.com/blog/inspect-element/)ã€‚æ‰¾åˆ°æ§åˆ¶å°å¹¶é”®å…¥ä»¥ä¸‹ä»£ç è¡Œ:

```
wp.data.select("core")
```

ç»“æœå°†æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå‡½æ•°åˆ—è¡¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥åˆ—è¡¨ä»`core`æ•°æ®å­˜å‚¨ä¸­è·å–æ•°æ®ã€‚è¿™äº›å‡½æ•°è¢«ç§°ä¸º**é€‰æ‹©å™¨**ï¼Œä½œä¸ºè®¿é—®çŠ¶æ€å€¼çš„æ¥å£ã€‚

![The Core WordPress data store object](img/8d46bf656b4c590ba3fdf0fda8480f09.png)

The Core WordPress data store object





### ä¿¡æ¯

`selectors`å¯¹è±¡åŒ…æ‹¬ä¸€ç»„ç”¨äºè®¿é—®å’Œå¯¼å‡ºçŠ¶æ€å€¼çš„å‡½æ•°ã€‚é€‰æ‹©å™¨æ˜¯ä¸€ä¸ªæ¥å—çŠ¶æ€å’Œå¯é€‰å‚æ•°å¹¶ä»çŠ¶æ€è¿”å›ä¸€äº›å€¼çš„å‡½æ•°ã€‚*è°ƒç”¨é€‰æ‹©å™¨æ˜¯ä»æ‚¨çš„çŠ¶æ€*ä¸­æ£€ç´¢æ•°æ®çš„ä¸»è¦æœºåˆ¶ï¼Œå¹¶ä½œä¸ºå¯¹åŸå§‹æ•°æ®çš„ä¸€ç§æœ‰ç”¨çš„æŠ½è±¡ï¼ŒåŸå§‹æ•°æ®é€šå¸¸æ›´å®¹æ˜“æ”¹å˜ï¼Œä¸å¤ªå®¹æ˜“ç”¨ä½œ[è§„èŒƒåŒ–å¯¹è±¡](https://redux.js.org/usage/structuring-reducers/normalizing-state-shape#designing-a-normalized-state)ã€‚(æ¥æº: [Github](https://github.com/WordPress/gutenberg/blob/9d4b83cbbafcd6c6cbd20c86b572f458fc65ff16/packages/data/README.md#selectors) )



WordPress æ•°æ®ä»“åº“åŒ…å«äº†å…³äº WordPress çš„ä¸€èˆ¬ä¿¡æ¯ï¼Œé€‰æ‹©å™¨æ˜¯ä½ è·å–è¿™äº›ä¿¡æ¯çš„é€”å¾„ã€‚ä¾‹å¦‚ï¼Œ`getCurrentUser()`è¿”å›å½“å‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯:

```
wp.data.select("core").getCurrentUser()
```

![Inspecting getCurrentUser response](img/441c015919b3d58d5b25e0b8a9be0673.png)

Inspecting getCurrentUser response



å¦ä¸€ä¸ªå¯ä»¥ç”¨æ¥ä»æ•°æ®å­˜å‚¨ä¸­æ£€ç´¢ç”¨æˆ·è¯¦ç»†ä¿¡æ¯çš„é€‰æ‹©å™¨æ˜¯`getUsers()` :

```
wp.data.select("core").getUsers()
```

ä¸‹å›¾æ˜¾ç¤ºäº†å“åº”å¯¹è±¡:

![Inspecting getUsers response](img/bb45e470c90233ef5c3dee9af2665fd7.png)

Inspecting getUsers response



è¦è·å–å•ä¸ªç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼Œåªéœ€é”®å…¥ä»¥ä¸‹è¡Œ:

```
wp.data.select("core").getUsers()[0]
```

ä½¿ç”¨ç›¸åŒçš„é€‰æ‹©å™¨ï¼Œæ‚¨è¿˜å¯ä»¥æ£€ç´¢åˆ†é…äº†`author`è§’è‰²çš„ç«™ç‚¹ç”¨æˆ·:

```
wp.data.select( 'core' ).getUsers({ who: 'authors' })
```

æ‚¨è¿˜å¯ä»¥æ£€ç´¢å·²æ³¨å†Œçš„åˆ†ç±»æ³•:

```
wp.data.select("core").getTaxonomies()
```

![Inspecting getTaxonomies response.](img/1203f3d66075cc7cf1c2314aa4fa629f.png)

Inspecting getTaxonomies response.



æ³¨å†Œå¸–å­ç±»å‹åˆ—è¡¨:

```
wp.data.select("core").getPostTypes()
```

æˆ–è€…æ’ä»¶åˆ—è¡¨:

```
wp.data.select("core").getPlugins()
```

ç°åœ¨è®©æˆ‘ä»¬å°è¯•è®¿é—®ä¸€ä¸ªä¸åŒçš„æ•°æ®å­˜å‚¨ã€‚ä¸ºæ­¤ï¼Œæ‚¨ä»å°†ä½¿ç”¨`select`å‡½æ•°ï¼Œä½†æä¾›ä¸åŒçš„åç§°ç©ºé—´ã€‚è®©æˆ‘ä»¬è¯•è¯•ä¸‹é¢çš„æ–¹æ³•:

```
wp.data.select("core/edit-post")
```

ç°åœ¨ï¼Œæ‚¨å°†è·å¾—ä»¥ä¸‹å“åº”å¯¹è±¡ã€‚

![Accessing the Editorâ€™s UI Data](img/90f8d2ed43c1096f46380232c761ea16.png)

Accessing the Editorâ€™s UI Data



å¦‚æœæ‚¨æƒ³çŸ¥é“è®¾ç½®å·¥å…·æ¡æ˜¯å¦æ‰“å¼€ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`isEditorSidebarOpened`é€‰æ‹©å™¨:

```
wp.data.select("core/edit-post").isEditorSidebarOpened()
```

å¦‚æœä¾§è¾¹æ æ˜¯æ‰“å¼€çš„ï¼Œè¯¥å‡½æ•°è¿”å›`true`:

![The sidebar is open.](img/dd5777a6f03edda3dc9e852fcf23b0e9.png)

The sidebar is open.



## å¦‚ä½•è®¿é—®å¸–å­æ•°æ®

ç°åœ¨ï¼Œæ‚¨åº”è¯¥å¯¹å¦‚ä½•è®¿é—®æ•°æ®æœ‰äº†åŸºæœ¬çš„äº†è§£ã€‚ç°åœ¨æˆ‘ä»¬æ¥ä»”ç»†çœ‹çœ‹ä¸€ä¸ªç‰¹å®šçš„é€‰æ‹©å™¨ï¼Œå³ [`getEntityRecords`å‡½æ•°](https://developer.wordpress.org/block-editor/reference-guides/data/data-core/#getentityrecords)ï¼Œå®ƒæ˜¯è®¿é—®å¸–å­æ•°æ®çš„é€‰æ‹©å™¨ã€‚

åœ¨ç¨‹åºå—ç¼–è¾‘å™¨ä¸­ï¼Œå³å‡»å¹¶é€‰æ‹©**æ£€æŸ¥**ã€‚åœ¨æ§åˆ¶å°é€‰é¡¹å¡ä¸­ï¼Œå¤åˆ¶å¹¶ç²˜è´´ä»¥ä¸‹è¡Œ:

```
wp.data.select("core").getEntityRecords('postType', 'post')
```

è¿™ä¼šå‘ Rest API å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¹¶è¿”å›ä¸€ä¸ªä¸æœ€è¿‘å‘å¸ƒçš„åšå®¢æ–‡ç« ç›¸å¯¹åº”çš„è®°å½•æ•°ç»„ã€‚

![getEntityRecords returns a list of posts.](img/56787eb55048c21118cc714bca2d8420.png)

getEntityRecords returns a list of posts.





### ä¿¡æ¯

æ³¨æ„ï¼Œç¬¬ä¸€æ¬¡å‘ Rest API å‘é€è¯·æ±‚æ—¶ï¼Œå“åº”å°†æ˜¯`null`ï¼Œç›´åˆ°è¯·æ±‚å®Œæˆã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ å¾—åˆ°äº†`null`ï¼Œä¸è¦æ‹…å¿ƒï¼Œå†è¯•ä¸€æ¬¡ã€‚



`getEntityRecords`æ¥å—[ä¸‰ä¸ªå‚æ•°](https://developer.wordpress.org/block-editor/reference-guides/data/data-core/#getentityrecords):

*   `kind` *å­—ç¬¦ä¸²*:å®ä½“ç§ç±»(å³`postType`)ã€‚
*   `name` *å­—ç¬¦ä¸²*:å®ä½“åç§°(å³`post`)ã€‚
*   `query`T2ï¼Ÿå¯¹è±¡:å¯é€‰æ¡ä»¶æŸ¥è¯¢(å³`{author: 0}`)ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨å‚æ•°çš„[å¯¹è±¡æ„å»ºæ›´å…·ä½“çš„è¯·æ±‚ã€‚](https://developer.wordpress.org/rest-api/reference/posts/#arguments)

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å†³å®šå›å¤åªåŒ…å«ç‰¹å®šç±»åˆ«çš„å¸–å­:

```
wp.data.select("core").getEntityRecords('postType', 'post', {categories: 3})
```

æ‚¨ä¹Ÿå¯ä»¥åªè¯·æ±‚æ¥è‡ªç»™å®šä½œè€…çš„æ–‡ç« :

```
wp.data.select("core").getEntityRecords('postType', 'post', {author: 2})
```

å¦‚æœæ‚¨å•å‡»ç”±`getEntityRecords`è¿”å›çš„ä»»ä½•è®°å½•ï¼Œæ‚¨å°†è·å¾—æ‰€é€‰è®°å½•çš„å±æ€§åˆ—è¡¨:

![An example API request with getEntityRecords.](img/e115422d069de6919676d89609b3f44c.png)

An example API request with getEntityRecords.



å¦‚æœæ‚¨å¸Œæœ›å“åº”åŒ…æ‹¬ç‰¹è‰²å›¾ç‰‡ï¼Œæ‚¨éœ€è¦åœ¨ä¹‹å‰çš„è¯·æ±‚ä¸­æ·»åŠ ä¸€ä¸ªé¢å¤–çš„å‚æ•°:

```
wp.data.select("core").getEntityRecords('postType', 'post', {author: 2, _embed: true})
```

![Featured image details in getEntityRecords response.](img/af4cbfe53cd3bc553b92445eaef3ec55.png)

Featured image details in getEntityRecords response.



ç°åœ¨ä½ åº”è¯¥å¯¹å¦‚ä½•è®¿é—® WordPress æ•°æ®åº“å’Œæ£€ç´¢æ–‡ç« ç»†èŠ‚æœ‰äº†æ›´å¥½çš„ç†è§£ã€‚å…³äº`getEntityRecords`é€‰æ‹©å™¨çš„è¯¦ç»†è§†å›¾ï¼Œè¯·å‚è§[ä½¿ç”¨ getEntityRecords](https://ryanwelcher.com/2021/08/requesting-data-in-gutenberg-with-getentityrecords/) åœ¨å¤è…¾å ¡è¯·æ±‚æ•°æ®ã€‚

## å¦‚ä½•åˆ›å»ºåŠ¨æ€å—:ç¤ºä¾‹é¡¹ç›®

åœ¨æˆ‘ä»¬çš„é•¿æœŸç†è®ºå‰æä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ç»ƒä¹ ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬åœ¨ä»¥å‰çš„å—å¼€å‘æ•™ç¨‹ä¸­ä»‹ç»çš„å·¥å…·åˆ›å»ºä¸€ä¸ªåŠ¨æ€å—ã€‚

åœ¨é‚£ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†:

1.  [å¦‚ä½•å»ºç«‹ WordPress å¼€å‘ç¯å¢ƒ](https://kinsta.com/blog/gutenberg-blocks/#setting-up-your-wordpress-development-environment)
2.  [ä»€ä¹ˆæ˜¯å—çŠ¶è„šæ‰‹æ¶](https://kinsta.com/blog/gutenberg-blocks/#a-walkthrough-of-the-starter-block-scaffolding)
3.  [å¦‚ä½•æ„å»ºé™æ€å¤è…¾å ¡å—](https://kinsta.com/blog/gutenberg-blocks/#the-project-building-your-first-gutenberg-block)

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä¼šåœ¨æœ¬æ–‡ä¸­æ·±å…¥è®¨è®ºè¿™äº›ä¸»é¢˜ï¼Œä½†æ˜¯è¯·éšæ„å‚è€ƒæˆ‘ä»¬ä»¥å‰çš„æŒ‡å—ä»¥è·å¾—æ›´å¤šä¿¡æ¯ï¼Œæˆ–è€…åªæ˜¯å¤ä¹ ä¸€ä¸‹ã€‚

### è®¾ç½® JavaScript å¼€å‘ç¯å¢ƒ

è®©æˆ‘ä»¬ä»è®¾ç½®ä¸€ä¸ª JavaScript å¼€å‘ç¯å¢ƒå¼€å§‹ã€‚

#### å®‰è£…æˆ–æ›´æ–° Node.js

é¦–å…ˆï¼Œ[å®‰è£…æˆ–æ›´æ–°](https://nodejs.org/en/download/) Node.jsã€‚å®Œæˆåï¼Œå¯åŠ¨å‘½ä»¤è¡Œå·¥å…·å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
node -v
```

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ‚¨çš„èŠ‚ç‚¹ç‰ˆæœ¬ã€‚

#### è®¾ç½®æ‚¨çš„å¼€å‘ç¯å¢ƒ

æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦ä¸€ä¸ª WordPress çš„å¼€å‘ç¯å¢ƒã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† [DevKinsta](https://kinsta.com/devkinsta/) ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„å…è´¹ WordPress å¼€å‘å·¥å…·ï¼Œå¯ä»¥è®©ä½ ç«‹åˆ»å¯åŠ¨ä¸€ä¸ªæœ¬åœ° WordPress ç½‘ç«™ã€‚

![Creating a custom site in DevKinsta](img/54e8701e4aca7b7a8385b55b56725589.png)

Creating a custom site in DevKinsta



ä½†æ˜¯ä½ ä»ç„¶å¯ä»¥è‡ªç”±é€‰æ‹©ä»»ä½•ä½ å–œæ¬¢çš„ [WordPress æœ¬åœ°å¼€å‘ç¯å¢ƒ](https://kinsta.com/ebooks/wordpress/wordpress-local-development/)ï¼Œæ¯”å¦‚ MAMP æˆ–è€… XAMPPï¼Œç”šè‡³æ˜¯å®˜æ–¹çš„ [wp-env è§£å†³æ–¹æ¡ˆ](https://www.npmjs.com/package/@wordpress/env)ã€‚

å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ DevKinstaï¼Œç‚¹å‡»**æ–°çš„ WordPress ç«™ç‚¹**æˆ–**è‡ªå®šä¹‰ç«™ç‚¹**ï¼Œå¡«å†™è¡¨æ ¼å­—æ®µå¹¶ç‚¹å‡»**åˆ›å»ºç«™ç‚¹**ã€‚

å®‰è£…è¿‡ç¨‹éœ€è¦ä¸€ä¸¤åˆ†é’Ÿã€‚å®Œæˆåï¼Œå¯åŠ¨ä½ çš„æœ¬åœ° WordPress å¼€å‘ç½‘ç«™ã€‚

![Site Info screen in DevKinsta.](img/6110c482ba8d425d1248bf6429a7308f.png)

Site Info screen in DevKinsta.



#### è®¾ç½®æ‚¨çš„é˜»æ­¢æ’ä»¶

ä½ ç°åœ¨éœ€è¦çš„æ˜¯ä¸€ä¸ªå…¥é—¨æ’ä»¶ã€‚ä¸ºäº†é¿å…æ‰‹åŠ¨é…ç½®çš„æ‰€æœ‰éº»çƒ¦ï¼ŒWordPress [æ ¸å¿ƒå¼€å‘å›¢é˜Ÿ](https://developer.wordpress.org/block-editor/reference-guides/packages/packages-create-block/)å‘å¸ƒäº†[@ WordPress/create-block tool](https://www.npmjs.com/package/@wordpress/create-block)ï¼Œè¿™æ˜¯*å®˜æ–¹ç”¨äºåˆ›å»ºå¤è…¾å ¡åŒºå—*çš„é›¶é…ç½®å·¥å…·ã€‚

åœ¨æˆ‘ä»¬çš„[ä¸Šä¸€ç¯‡æ–‡ç« ](https://kinsta.com/blog/gutenberg-blocks/#dev-environment)ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ·±å…¥è®¨è®ºäº†`@wordpress/create-block`ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥é©¬ä¸Šå¼€å§‹è®¾ç½®ã€‚

åœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­ï¼Œå¯¼èˆªåˆ° **/wp-content/plugins** æ–‡ä»¶å¤¹:

![New terminal at folder in Mac OS.](img/f2a768e1ec366d97e5e8db208e9d3e5a.png)

New terminal at folder in Mac OS.



åœ¨é‚£é‡Œï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
npx @wordpress/create-block
```

æ‚¨ç°åœ¨å·²ç»å‡†å¤‡å¥½å®‰è£…`@wordpress/create-block`åŒ…äº†:

![Installing the @wordpress/create-block package.](img/74423c0bf4b63d9d1c2b61a872e84cbd.png)

Installing the @wordpress/create-block package.



è¦ç¡®è®¤ï¼Œé”®å…¥`y`å¹¶æŒ‰å›è½¦é”®ã€‚

è¿™å°†åœ¨[äº¤äº’æ¨¡å¼](https://kinsta.com/blog/gutenberg-blocks/#set-up-the-plugin)ä¸‹ç”Ÿæˆæ’ä»¶çš„ PHPã€SCSS å’Œ JS æ–‡ä»¶ã€‚

ä¸‹é¢æ˜¯æˆ‘ä»¬å°†åœ¨ç¤ºä¾‹ä¸­ä½¿ç”¨çš„è¯¦ç»†ä¿¡æ¯ã€‚æ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½éšæ„æ›´æ”¹è¿™äº›ç»†èŠ‚:



*   Block slug used for identification (also the name of plug-in and output folder): **author-plugin**
*   The internal namespace of the name (unique to your product): **author-box**
*   The display title of your block: **Author Box**
*   Short description of your block (optional): **Example block for Kinsta readers**
*   **It is easier to identify your block (optional): **Business Person****
***   Category name to help users browse and discover your block: **Widgets***   Name of plug-in author Multiple authors can be listed with commas: **Your name***   Short name of plug-in license (optional): **â€“***   Full text link of license (optional): **â€“**[T21**



ä¸€æ—¦æ‚¨è¾“å…¥å›è½¦ï¼Œå®ƒå°±ä¼šä¸‹è½½å¹¶é…ç½®æ’ä»¶ã€‚

![Installing the block plugin.](img/225d3bf2e1608d14626056da0f4b20c1.png)

Installing the block plugin.



è¯¥è¿‡ç¨‹å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿã€‚å®Œæˆåï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹å±å¹•:

![Block bootstrapped in the plugin folder.](img/960d0e448df89f2fd1e07a177b511950.png)

Block bootstrapped in the plugin folder.



æ‚¨å°†çœ‹åˆ°å¯ä»¥ä»æ’ä»¶ç›®å½•ä¸­è¿è¡Œçš„å‘½ä»¤åˆ—è¡¨:

*   `$ npm start`â€“å¼€å§‹æ„å»ºå¼€å‘ã€‚
*   `$ npm run build`â€“æ„å»ºç”Ÿäº§ä»£ç ã€‚
*   `$ npm run format`â€“æ ¼å¼åŒ–æ–‡ä»¶ã€‚
*   `$ npm run lint:css`â€“Lint CSS æ–‡ä»¶ã€‚
*   `$ npm run lint:js`â€“Lint JavaScript æ–‡ä»¶ã€‚
*   `$ npm run packages-update`â€“å°† WordPress è½¯ä»¶åŒ…æ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬ã€‚

å¥½äº†ï¼Œç°åœ¨ç”¨ä¸‹é¢çš„å‘½ä»¤ç§»åŠ¨åˆ°æ’ä»¶ç›®å½•:

```
cd author-plugin
```

å¹¶å¼€å§‹æ‚¨çš„å¼€å‘æ„å»º:

```
npm start
```

æ¥ä¸‹æ¥ï¼Œå¯¼èˆªåˆ°ä½ çš„ WordPress ä»ªè¡¨ç›˜ä¸­çš„æ’ä»¶å±å¹•ï¼Œæ¿€æ´»**ä½œè€…æ¡†**æ’ä»¶:

![The block plugin is listed in the Plugins screen.](img/4b06c30d25a696bf8740ad813139b86a.png)

The block plugin is listed in the Plugins screen.



ç°åœ¨ä½ å¯ä»¥æ£€æŸ¥æ’ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚åˆ›å»ºä¸€ä¸ªæ–°å¸–å­å¹¶å¼€å§‹è¾“å…¥`/`æ¥å¯åŠ¨å¿«é€Ÿæ’å…¥å™¨:

![The block item in the Quick Inserter.](img/fa47e142d3e963578054058c34d65c01.png)

The block item in the Quick Inserter.



ä½ è¿˜å¯ä»¥åœ¨å—æ’å…¥å™¨ä¸­çš„**å°éƒ¨ä»¶**ç±»åˆ«ä¸‹æ‰¾åˆ°**ä½œè€…æ¡†**å—ã€‚é€‰æ‹©è¦æ·»åŠ åˆ°ç¼–è¾‘å™¨ç”»å¸ƒçš„å—:

![The WordPress Block Inserter.](img/e7139a9b486adaf14be689a3797b1fb5.png)

The WordPress Block Inserter



ä½ å®Œäº†ã€‚ç°åœ¨ä¿å­˜æ–‡ç« å¹¶é¢„è§ˆé¡µé¢ï¼Œæ£€æŸ¥å—æ˜¯å¦æ­£ç¡®æ˜¾ç¤ºã€‚

#### å—çŠ¶è„šæ‰‹æ¶

æˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°äº†å—çŠ¶è„šæ‰‹æ¶ã€‚å› æ­¤ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†åªæä¾›ä¸€ä¸ªå¿«é€Ÿçš„æ¦‚è¿°æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†ä¿®æ”¹æˆ‘ä»¬çš„ä¾‹å­ã€‚

æ ¹æ–‡ä»¶å¤¹
æ ¹æ–‡ä»¶å¤¹æ˜¯ä½ å¯ä»¥æ‰¾åˆ°ä¸» PHP æ–‡ä»¶å’Œå‡ ä¸ªå­æ–‡ä»¶å¤¹çš„åœ°æ–¹ã€‚

**author-plugin.php**T3`@wordpress/create-block`åŒ…é»˜è®¤æä¾›ä»¥ä¸‹ [PHP æ–‡ä»¶](https://kinsta.com/blog/gutenberg-blocks/#plugin-file):

```
/**
 * Plugin Name:       Author box
 * Description:       An example block for Kinsta readers
 * Requires at least: 5.8
 * Requires PHP:      7.0
 * Version:           0.1.0
 * Author:            Carlo
 * License:           GPL-2.0-or-later
 * License URI:       https://www.gnu.org/licenses/gpl-2.0.html
 * Text Domain:       author-plugin
 *
 * @package           author-box
 */

/**
 * Registers the block using the metadata loaded from the `block.json` file.
 * Behind the scenes, it registers also all assets so they can be enqueued
 * through the block editor in the corresponding context.
 *
 * @see https://developer.wordpress.org/reference/functions/register_block_type/
 */
function author_box_author_plugin_block_init() {
	register_block_type( __DIR__ . '/build' );
}
add_action( 'init', 'author_box_author_plugin_block_init' );
```

åœ¨æ ‡é¢˜ä¸­ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°æˆ‘ä»¬åœ¨è®¾ç½®ä¸­è¾“å…¥çš„è¯¦ç»†ä¿¡æ¯ã€‚

å¯¹äºé™æ€å—ï¼Œå¤§éƒ¨åˆ†æ—¶é—´ä½ å°†å¤„ç†ä½äº *src* æ–‡ä»¶å¤¹ä¸­çš„ JavaScript æ–‡ä»¶ã€‚å¯¹äºåŠ¨æ€å—ï¼Œæ‚¨å°†ç¼–å†™ PHP ä»£ç åœ¨å‰ç«¯æ˜¾ç¤ºå—å†…å®¹ã€‚

***src*æ–‡ä»¶å¤¹**
*src*æ–‡ä»¶å¤¹æ˜¯ä½ çš„å¼€å‘æ–‡ä»¶å¤¹ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä»¥ä¸‹æ–‡ä»¶:

*   *block.json*
*   *index.js*
*   *edit.js*
*   *save.js*
*   *editor.scss*
*   *style.scss*

**block . JSON**T3*block . JSON*æ˜¯ä½ çš„å…ƒæ•°æ®æ–‡ä»¶ã€‚`@wordpress/create-block`ç”Ÿæˆä¸‹é¢çš„ **block.json** æ–‡ä»¶:

```
{
	"$schema": "https://schemas.wp.org/trunk/block.json",
	"apiVersion": 2,
	"name": "author-box/author-plugin",
	"version": "0.1.0",
	"title": "Author box",
	"category": "widgets",
	"icon": "businessperson",
	"description": "An example block for Kinsta readers",
	"supports": {
		"html": false
	},
	"textdomain": "author-plugin",
	"editorScript": "file:./index.js",
	"editorStyle": "file:./index.css",
	"style": "file:./style-index.css"
}
```

è¦æ›´ä»”ç»†åœ°æŸ¥çœ‹ *block.json* æ–‡ä»¶ï¼Œè¯·å‚è€ƒ[æˆ‘ä»¬ä¹‹å‰çš„åšå®¢æ–‡ç« ](https://kinsta.com/blog/gutenberg-blocks/#block-json)ã€‚

**index . js**
*index . js*æ–‡ä»¶æ˜¯ä½ åœ¨å®¢æˆ·ç«¯æ³¨å†Œå—ç±»å‹çš„åœ°æ–¹:

```
import { registerBlockType } from '@wordpress/blocks';

import './style.scss';

import Edit from './edit';
import save from './save';

registerBlockType('author-box/author-plugin', {
	edit: Edit,
	save,
});
```

**edit.js**

```
import { __ } from '@wordpress/i18n';

import { useBlockProps } from '@wordpress/block-editor';

import './editor.scss';

export default function Edit() {
	return (
		<p {...useBlockProps()}>
			{__('Author box â€“ hello from the editor!', 'author-plugin')}
		</p>
	);
}
```

**save . js**
*save . js*æ–‡ä»¶åŒ…å«æ„å»ºè¦ä¿å­˜åˆ°æ•°æ®åº“ä¸­çš„å—å†…å®¹çš„è„šæœ¬ã€‚æˆ‘ä»¬ä¸ä¼šåœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨è¯¥æ–‡ä»¶:

```
import { __ } from '@wordpress/i18n';

import { useBlockProps } from '@wordpress/block-editor';

export default function save() {
	return (
		<p {...useBlockProps.save()}>
			{__('Author box â€“ hello from the saved content!', 'author-plugin')}
		</p>
	);
}
```

## æ„å»ºè¦åœ¨ç¼–è¾‘å™¨ä¸­å‘ˆç°çš„å—

åœ¨ [Visual Studio ä»£ç ](https://kinsta.com/blog/best-text-editors/#visual-studio-code)æˆ–ä»»ä½•ä½ å–œæ¬¢çš„[ä»£ç ç¼–è¾‘å™¨](https://kinsta.com/blog/best-text-editors/)ä¸­æ‰“å¼€ä½ çš„é¡¹ç›®ã€‚

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Visual Studio ä»£ç ï¼Œè¿›å…¥**ç»ˆç«¯- >æ–°å»ºç»ˆç«¯**ã€‚è¿™å°†åœ¨é¡¹ç›®çš„æ ¹æ–‡ä»¶å¤¹ä¸­å¯åŠ¨ä¸€ä¸ªç»ˆç«¯çª—å£ã€‚

åœ¨ç»ˆç«¯ä¸­(æˆ–åœ¨æ‚¨å–œæ¬¢çš„å‘½ä»¤è¡Œå·¥å…·ä¸­)ï¼Œé”®å…¥ä»¥ä¸‹å‘½ä»¤:

```
npm start
```

æ‚¨ç°åœ¨æ­£åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡ŒèŠ‚ç‚¹ç¯å¢ƒã€‚

![The block plugin project in Visual Studio Code.](img/0e84eec7773f40ea81fea119d2d1a4c5.png)

The block plugin project in Visual Studio Code.



ä»ç°åœ¨å¼€å§‹ï¼Œä½ å°†éµå¾ªä¸¤æ¡ä¸åŒçš„è·¯çº¿ã€‚ä¸ºäº†åœ¨ç¼–è¾‘å™¨ä¸­æ¸²æŸ“å—ï¼Œæ‚¨å°†åœ¨ *edit.js* æ–‡ä»¶ä¸­å·¥ä½œã€‚è¦åœ¨å‰ç«¯å‘ˆç°è¿™ä¸ªå—ï¼Œæ‚¨éœ€è¦åœ¨ä¸»æ’ä»¶æ–‡ä»¶ä¸­ç¼–å†™ PHP ä»£ç ã€‚

ç°åœ¨å·èµ·è¢–å­ï¼Œå› ä¸ºç¼–ç å¼€å§‹äº†:

 

### ä¿¡æ¯

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬åªæä¾›ä»£ç ç‰‡æ®µã€‚å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨ Gist ä¸Šæ‰¾åˆ°ã€‚



### åœ¨æœåŠ¡å™¨ä¸Šæ³¨å†Œè¯¥å—

é¦–å…ˆï¼Œæ‚¨å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Šæ³¨å†Œè¿™ä¸ªå—ï¼Œå¹¶ç¼–å†™ PHP ä»£ç ä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®ã€‚

åœ¨*author-plugin.php*æ–‡ä»¶ä¸­ï¼Œæ‚¨éœ€è¦å‘ [`register_block_type`å‡½æ•°](https://kinsta.com/blog/gutenberg-blocks/#plugin-file)ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°:

```
function author_box_author_plugin_block_init() {
	register_block_type( __DIR__ . '/build', array(
		'render_callback' => 'author_box_author_plugin_render_author_content'
	) );
}
add_action( 'init', 'author_box_author_plugin_block_init' );
```

ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ³¨å†Œä¸€ä¸ªå—ç±»å‹çš„å‚æ•°æ•°ç»„(å‚è§[è¿™é‡Œçš„](https://developer.wordpress.org/reference/classes/wp_block_type/__construct/)å¯ç”¨å‚æ•°çš„å®Œæ•´åˆ—è¡¨)ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åªæä¾›äº†`render_callback`ï¼Œå®ƒå†³å®šäº†åœ¨å±å¹•ä¸Šå‘ˆç°å—çš„å›è°ƒå‡½æ•°ã€‚

æ¥ä¸‹æ¥ï¼Œæ‚¨å°†å£°æ˜è¯¥å‡½æ•°:

```
function author_box_author_plugin_render_author_content() {
	return 'Hello World!';
}
```

ä¿å­˜æ–‡ä»¶ï¼Œåˆ›å»ºæ–°çš„æ–‡ç« æˆ–é¡µé¢ï¼Œå¹¶å°†**ä½œè€…æ¡†**å—æ·»åŠ åˆ°ç¼–è¾‘å™¨ç”»å¸ƒã€‚

## æ³¨å†Œè®¢é˜…æ—¶äº‹é€šè®¯



### æƒ³çŸ¥é“æˆ‘ä»¬æ˜¯æ€ä¹ˆè®©æµé‡å¢é•¿è¶…è¿‡ 1000%çš„å—ï¼Ÿ

åŠ å…¥ 20ï¼Œ000 å¤šåè·å¾—æˆ‘ä»¬æ¯å‘¨æ—¶äº‹é€šè®¯å’Œå†…éƒ¨æ¶ˆæ¯çš„äººçš„è¡Œåˆ—å§ï¼

[Subscribe Now](#newsletter)

![The WordPress Block Inserter.](img/e7139a9b486adaf14be689a3797b1fb5.png)

The WordPress Block Inserter.



å—ç¼–è¾‘å™¨ä»ç„¶æ˜¾ç¤ºèµ·å§‹å—ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰æ›´æ”¹ *edit.js* æ–‡ä»¶ã€‚

ä½†æ˜¯å¦‚æœä½ åœ¨å‰ç«¯é¢„è§ˆè¿™ä¸ªå¸–å­ï¼Œä½ ä¼šçœ‹åˆ°åŸæ¥çš„å—å†…å®¹ç°åœ¨å·²ç»è¢«â€œHello Worldâ€å­—ç¬¦ä¸²æ›¿æ¢äº†ã€‚

ç°åœ¨ï¼Œç”±äºå‘ˆç°åœ¨å‰ç«¯çš„ HTML æ˜¯ç”± PHP æ–‡ä»¶ç”Ÿæˆçš„ï¼Œå› æ­¤ä¸å†éœ€è¦`save`å‡½æ•°è¿”å›ä»»ä½•å†…å®¹ã€‚æ‰€ä»¥è®©æˆ‘ä»¬ç›´æ¥è¿›å…¥ *save.js* æ–‡ä»¶ï¼Œä¿®æ”¹ä»£ç å¦‚ä¸‹æ‰€ç¤º:

```
export default function save() {
	return null;
}
```

### å®šä¹‰å—å±æ€§

ç°åœ¨ä½ éœ€è¦ä¸€ä¸ªå­˜å‚¨ç”¨æˆ·è®¾ç½®çš„åœ°æ–¹ã€‚ä¾‹å¦‚ï¼Œè¦ä»æ•°æ®åº“ä¸­æ£€ç´¢çš„æ–‡ç« æ•°é‡ã€æ˜¯å¦æ˜¾ç¤ºæŒ‡å®šçš„å­—æ®µç­‰ã€‚ä¸ºæ­¤ï¼Œæ‚¨å°†åœ¨ *block.json* æ–‡ä»¶ä¸­å®šä¹‰ä¸€äº›`attributes`ã€‚

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥è®©ç”¨æˆ·èƒ½å¤Ÿç¡®å®šè¦åŒ…å«åœ¨åŒºå—ä¸­çš„å¸–å­æ•°é‡ï¼Œé€‰æ‹©æ˜¾ç¤ºç‰¹è‰²å›¾ç‰‡ã€æ—¥æœŸã€æ‘˜è¦å’Œ/æˆ–éšè—/æ˜¾ç¤ºä½œè€…çš„ä¸ªäººèµ„æ–™å›¾ç‰‡ã€‚

ä¸‹é¢æ˜¯æˆ‘ä»¬å°†ç”¨æ¥æ„å»ºç¤ºä¾‹å—çš„å±æ€§çš„å®Œæ•´åˆ—è¡¨:

```
{
	...
	"attributes": {
		"numberOfItems": {
			"type": "number",
			"default": 3
		},
		"columns": {
			"type": "number",
			"default": 1
		},
		"displayDate": {
			"type": "boolean",
			"default": true
		},
		"displayExcerpt": {
			"type": "boolean",
			"default": true
		},
		"displayThumbnail": {
			"type": "boolean",
			"default": true
		},
		"displayAuthorInfo": {
			"type": "boolean",
			"default": true
		},
		"showAvatar": {
			"type": "boolean",
			"default": true
		}, 
		"avatarSize": {
			"type": "number",
			"default": 48
		},
		"showBio": {
			"type": "boolean",
			"default": true
		}
	}
}
```

### æ„å»ºè¦åœ¨ç¼–è¾‘å™¨ä¸­å‘ˆç°çš„å—

`getEntityRecords`é€‰æ‹©å™¨åŒ…å«åœ¨`@wordpress/data`åŒ…è£…ä¸­ã€‚è¦ä½¿ç”¨å®ƒï¼Œæ‚¨éœ€è¦ä»æ‚¨çš„`edit.js`æ–‡ä»¶ä¸­çš„é‚£ä¸ªåŒ…å¯¼å…¥`useSelect`é’©å­:

```
import { useSelect } from '@wordpress/data';
```



### ä¿¡æ¯

`useSelect`æ˜¯ä¸€ä¸ªå®šåˆ¶çš„ react é’©å­ï¼Œç”¨äºåŸºäº[React é’©å­](https://reactjs.org/docs/hooks-reference.html#usecallback)ä»æ³¨å†Œçš„é€‰æ‹©å™¨ä¸­æ£€ç´¢å€¼ã€‚



æ¥ä¸‹æ¥ï¼Œå°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`Edit()`å‡½æ•°ä¸­:

```
const posts = useSelect( ( select ) => {
	return select( 'core' ).getEntityRecords( 'postType', 'post', {
		'per_page': 3
	});
});
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç¡¬ç¼–ç äº†å¸–å­çš„æ•°é‡ã€‚ä½†æ˜¯æ‚¨å¯èƒ½å¸Œæœ›è®©ç”¨æˆ·èƒ½å¤Ÿè®¾ç½®ä¸åŒæ•°é‡çš„å¸–å­ã€‚æ‚¨å¯ä»¥ä¸ºæ­¤ä½¿ç”¨ä¸€ä¸ªå±æ€§ã€‚

åœ¨ä½ çš„ *block.json* ä¸­ï¼Œä½ åº”è¯¥å·²ç»å®šä¹‰äº†ä¸€ä¸ª`numberOfItems`å±æ€§ã€‚æ‚¨å¯ä»¥åœ¨æ‚¨çš„`Edit`å‡½æ•°ä¸­ä½¿ç”¨å®ƒï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
export default function Edit( { attributes } ) {

	const { numberOfItems } = attributes;

	const posts = useSelect( ( select ) => {
		return select( 'core' ).getEntityRecords( 'postType', 'post', {
			'per_page': numberOfItems
		});
	});

	console.log( posts );

	return (
		...
	);
}
```

ä½ è¿˜ä¸ä¼šåœ¨å±å¹•ä¸Šçœ‹åˆ°å¸–å­ï¼Œä½†æ˜¯è¿è¡Œä¸€ä¸ª`console.log`çœ‹çœ‹åœ¨æµè§ˆå™¨æ£€æŸ¥å™¨çš„æ§åˆ¶å°ä¸Šä¼šå‘ç”Ÿä»€ä¹ˆ:

![The result in the browser's console.](img/a83474a7d75adbb9829db45f12c1fc72.png)

The result in the browserâ€™s console.



[`useSelect`å¯èƒ½æœ‰ä¸¤ä¸ªå‚æ•°](https://developer.wordpress.org/block-editor/reference-guides/packages/packages-data/#useselect):ä¸€ä¸ªå†…è”å›è°ƒå’Œä¸€ä¸ªä¾èµ–æ•°ç»„ã€‚ä¸¤è€…éƒ½è¿”å›äº†å›è°ƒçš„[è®°å¿†](https://en.wikipedia.org/wiki/Memoization)ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬ä»…åœ¨ä¾èµ–å…³ç³»ä¹‹ä¸€æ”¹å˜æ—¶æ‰æ”¹å˜ã€‚

å› æ­¤ï¼Œä¸ºäº†åœ¨æ¯æ¬¡`numberOfItems`å±æ€§æ”¹å˜æ—¶é‡æ–°æå–å¸–å­ï¼Œæ‚¨å¿…é¡»æ”¹å˜`Edit`å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
export default function Edit( { attributes } ) {

	const { numberOfItems } = attributes;

	const posts = useSelect(
		( select ) => {
			return select( 'core' ).getEntityRecords( 'postType', 'post', {
				'per_page': numberOfItems
			});
		}, 
		[ numberOfItems ]
	);

	console.log(posts);

	return (
		...
	);
}
```

æ¥ä¸‹æ¥ä½ å¿…é¡»[å‘ˆç°ä½ çš„å¸–å­åˆ—è¡¨](https://reactjs.org/docs/lists-and-keys.html)ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å†…ç½®çš„ [JavaScript `map`æ–¹æ³•](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map):

```
export default function Edit( { attributes } ) {

	const { numberOfItems } = attributes;

	const posts = useSelect(
		( select ) => {
			return select( 'core' ).getEntityRecords( 'postType', 'post', {
				'per_page': numberOfItems
			});
		},
		[ numberOfItems ]
	);

	console.log(posts);

	return (
		<div { ...useBlockProps() }>
			<ul>
				{ posts && posts.map( ( post ) => {
					return (
						<li key={ post.id }>
							<h5>
								<a href={ post.link }>
									{ 
										post.title.rendered ? 
										post.title.rendered :
										__( 'Default title', 'author-plugin' )
									}
								</a>
							</h5>
						</li>
					)
				})}
			</ul>
		</div>
	);
}
```

é¦–å…ˆï¼Œå®ƒæ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ª postï¼Œç„¶åè¿è¡Œå¾ªç¯ã€‚



### ä¿¡æ¯

`map()`æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå…¶ä¸­å¡«å……äº†è°ƒç”¨æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„å‡½æ•°çš„ç»“æœâ€”â€”Source:[MDN web docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map)ã€‚



æ³¨æ„ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨äº†å¸¦æœ‰ React ç»„ä»¶çš„`map`æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨äº†ä¸€ä¸ª`key`å±æ€§æ¥ä¸ºå½“å‰åˆ—è¡¨é¡¹åˆ†é…æ–‡ç«  IDã€‚



### ä¿¡æ¯

â€œkeyâ€æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²å±æ€§ï¼Œæ‚¨éœ€è¦åœ¨åˆ›å»ºå…ƒç´ åˆ—è¡¨æ—¶åŒ…å«å®ƒâ€”â€”Source:[list å’Œ React Docs ä¸­çš„ key](https://reactjs.org/docs/lists-and-keys.html)ã€‚



`post.link`å’Œ`post.title.rendered`åˆ†åˆ«æ¸²æŸ“å¸–å­ç½‘å€å’Œæ ‡é¢˜ã€‚

ä¸‹å›¾æ˜¾ç¤ºäº†`post`å¯¹è±¡å±æ€§çš„å®Œæ•´åˆ—è¡¨ã€‚

![The Post object.](img/754ec467329a26118165f72c19a8dd29.png)

The Post object.



ä¸Šé¢çš„ä»£ç åªæ˜¯ä¸€ä¸ªä½¿ç”¨`getEntityRecords`çš„åŸºæœ¬ä¾‹å­ã€‚ç°åœ¨æ˜¯æŠŠæˆ‘ä»¬çš„çŸ¥è¯†ä»˜è¯¸å®è·µçš„æ—¶å€™äº†ã€‚

å‡è®¾æ‚¨å¸Œæœ›é˜»æ­¢æ‚¨çš„å—å‘ˆç°ç”¨æˆ·å¯èƒ½æ·»åŠ åˆ°æ–‡ç« æ ‡é¢˜ä¸­çš„ HTML æ ‡è®°ã€‚WordPress ä¸ºæ­¤æä¾›äº†ä¸€ä¸ª [`RawHTML`ç»„ä»¶](https://developer.wordpress.org/block-editor/reference-guides/packages/packages-element/#rawhtml)ã€‚

é¦–å…ˆï¼Œæ‚¨å°†ä» [@wordpress/element åŒ…](https://developer.wordpress.org/block-editor/reference-guides/packages/packages-element/)ä¸­å¯¼å…¥ç»„ä»¶:

```
import { RawHTML } from '@wordpress/element';
```

æ¥ä¸‹æ¥ï¼Œæ‚¨å°†æŠŠæ–‡ç« æ ‡é¢˜æ”¾åœ¨ä¸€ä¸ª`RawHTML`å…ƒç´ ä¸­:

```
<div { ...useBlockProps() }>
	<ul>
		{ posts && posts.map((post) => {
			return (
				<li key={ post.id }>
					<h5>
						<a href={ post.link }>
							{ post.title.rendered ? (
								<RawHTML>
									{ post.title.rendered }
								</RawHTML>
							) : (
								__( 'Default title', 'author-plugin' )
							)}
						</a>
					</h5>
				</li>
			)
		})}
	</ul>
</div>
```

ä»…æ­¤è€Œå·²ã€‚ç°åœ¨ç»™ä½ çš„æ–‡ç« æ ‡é¢˜æ·»åŠ ä¸€ä¸ª HTML æ ‡ç­¾å¹¶ä¿å­˜æ–‡ç« ã€‚ç„¶ååœ¨æœ‰å’Œæ²¡æœ‰`RawHTML`çš„æƒ…å†µä¸‹æµ‹è¯•ä½ çš„ä»£ç ï¼Œçœ‹çœ‹ä½ çš„ä»£ç å—çš„å†…å®¹åœ¨å±å¹•ä¸Šæ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚

### æ·»åŠ æ—¥æœŸ

WordPress æä¾›äº†è®¸å¤š JavaScript å‡½æ•°æ¥ç®¡ç†å’Œæ ¼å¼åŒ–æ—¥æœŸã€‚è¦ä½¿ç”¨è¿™äº›å‡½æ•°ï¼Œä½ é¦–å…ˆéœ€è¦ä» [`@wordpress/date`åŒ…](https://developer.wordpress.org/block-editor/reference-guides/packages/packages-date/)ä¸­çš„ *edit.js* æ–‡ä»¶ä¸­å¯¼å…¥å®ƒä»¬:

```
import { dateI18n, format, __experimentalGetSettings } from '@wordpress/date';
```

*   æ ¼å¼åŒ–ä¸€ä¸ªæ—¥æœŸï¼Œå°†å…¶ç¿»è¯‘æˆç«™ç‚¹çš„è¯­è¨€ç¯å¢ƒã€‚
*   `format`:æ ¼å¼åŒ–æ—¥æœŸã€‚
*   `__experimentalGetSettings`:ä»¥ WordPress é€šç”¨è®¾ç½®ä¸­è®¾ç½®çš„æ ¼å¼æ˜¾ç¤ºæ—¥æœŸã€‚

è¿™äº›å‡½æ•°æ²¡æœ‰è¢«è®°å½•ï¼Œä½†æ˜¯æ‚¨å¯ä»¥åœ¨å‡ ä¸ªå—çš„æºä»£ç ä¸­æ‰¾åˆ°æœ‰ç”¨çš„ä¾‹å­ã€‚ä¾‹å¦‚ï¼Œå‚è§[æœ€æ–°å¸–å­](https://github.com/WordPress/gutenberg/blob/trunk/packages/block-library/src/latest-posts/edit.js)å’Œ[å‘å¸ƒæ—¥æœŸ](https://github.com/WordPress/gutenberg/blob/trunk/packages/block-library/src/post-date/edit.js) *edit.js* æ–‡ä»¶ã€‚

ç°åœ¨æ·»åŠ `displayDate`å±æ€§:

```
const { numberOfItems, displayDate } = attributes;
```

ç„¶ååœ¨`<li>`å…ƒç´ ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç :

```
{ 
	displayDate && (
		<time
			className='wp-block-author-box-author-plugin__post-date'
			dateTime={ format( 'c', post.date_gmt ) }
		>
			{ dateI18n(
				__experimentalGetSettings().formats.date, 
				post.date_gmt
			)}
		</time>
	) 
}
```

è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

*   å¦‚æœ`displayDate`æ˜¯`true`ï¼Œé‚£ä¹ˆä½¿ç”¨ [`time`å…ƒç´ ](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/time)æ˜¾ç¤ºæ—¥æœŸã€‚
*   `dateTime`å±æ€§ä»¥[å…è®¸çš„æ ¼å¼](https://wordpress.org/support/article/formatting-date-and-time/)ä¹‹ä¸€æä¾›å…ƒç´ çš„æ—¶é—´å’Œ/æˆ–æ—¥æœŸã€‚
*   `dateI18n`æ£€ç´¢æœ¬åœ°åŒ–æ ¼å¼çš„æ—¥æœŸã€‚è¿™ä¸ªå‡½æ•°çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äº PHP [PHP `date_i18n` WordPress å‡½æ•°](https://developer.wordpress.org/reference/functions/date_i18n/)ã€‚

### æ·»åŠ æ‘˜å½•

ç°åœ¨æ·»åŠ æ–‡ç« æ‘˜å½•åº”è¯¥å¾ˆå®¹æ˜“äº†ã€‚é¦–å…ˆï¼Œçœ‹çœ‹æµè§ˆå™¨æ£€æŸ¥å™¨ä¸­çš„`excerpt`å±æ€§ã€‚æ‚¨å°†çœ‹åˆ°å®é™…å†…å®¹å­˜å‚¨åœ¨`excerpt.rendered`ä¸­ã€‚

![Inspecting the post excerpt in Chrome DevTools.](img/724d27b5dad8835b5cc1b185f472deb9.png)

Inspecting the post excerpt in Chrome DevTools.



æ¥ä¸‹æ¥ï¼Œå°†`displayExcerpt`å±æ€§æ·»åŠ åˆ°`attributes`å¯¹è±¡ä¸­:

```
const { numberOfItems, displayDate, displayExcerpt } = attributes;
```

ç„¶ååœ¨`Edit`å‡½æ•°ä¸­çš„`</li>`ç»“æŸæ ‡è®°å‰æ·»åŠ ä»¥ä¸‹ä»£ç :

```
{
	displayExcerpt &&
	post.excerpt.rendered && (
		<p>
			<RawHTML>
				{ post.excerpt.rendered }
			</RawHTML>
		</p>
	)
}
```

å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰ JavaScriptï¼Œåœ¨è¿™é‡Œå’Œä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº†**çŸ­è·¯è¯„ä¼°**ï¼Œå¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½ä¸ºçœŸï¼Œåˆ™è¿”å›æœ€åä¸€ä¸ªæ“ä½œæ•°çš„å€¼(åœ¨ [Inline If with é€»è¾‘& &è¿ç®—ç¬¦](https://reactjs.org/docs/conditional-rendering.html#inline-if-with-logical--operator)å’Œ[é€»è¾‘ AND ( & & )](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_AND) ä¸­æœ‰æ›´å¤šä¿¡æ¯)ã€‚



### ä¿¡æ¯

åœ¨ JavaScript ä¸­ï¼Œ`true && expression`æ€»æ˜¯è®¡ç®—ä¸º`expression`ï¼Œ`false && expression`æ€»æ˜¯è®¡ç®—ä¸º`false`ã€‚

å› æ­¤ï¼Œå¦‚æœæ¡ä»¶ä¸º`true`ï¼Œç´§æ¥åœ¨`&&`ä¹‹åçš„å…ƒç´ å°†å‡ºç°åœ¨è¾“å‡ºä¸­ã€‚å¦‚æœæ˜¯`false`ï¼ŒReact ä¼šå¿½ç•¥å¹¶è·³è¿‡å®ƒã€‚æ¥æº:React æ–‡æ¡£ä¸­çš„[æ¡ä»¶æ¸²æŸ“](https://reactjs.org/docs/conditional-rendering.html#inline-if-with-logical--operator)ã€‚



æœ€åï¼Œæ‚¨å¯ä»¥å†æ¬¡æµ‹è¯•æ‚¨çš„ä»£ç ã€‚æ›´æ”¹ *block.json* æ–‡ä»¶ä¸­çš„å±æ€§å€¼ï¼Œçœ‹çœ‹ç¼–è¾‘å™¨ä¸­ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

### æ·»åŠ ç‰¹è‰²å›¾ç‰‡

ç°åœ¨æ‚¨éœ€è¦æ·»åŠ å‘ˆç°ç‰¹è‰²å›¾åƒçš„ä»£ç ã€‚å¼€å§‹å‘`attributes`æ·»åŠ `displayThumbnail`å±æ€§:

Struggling with downtime and WordPress problems? Kinsta is the hosting solution designed to save you time! [Check out our features](https://kinsta.com/features/)

```
const { 
	numberOfItems, 
	displayDate, 
	displayExcerpt, 
	displayThumbnail 
} = attributes;
```

ç°åœ¨æ‚¨éœ€è¦å¼„æ¸…æ¥šç‰¹è‰²å›¾åƒå­˜å‚¨åœ¨å“ªé‡Œã€‚æ­£å¦‚æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ï¼Œè¦è·å¾—ç‰¹è‰²å›¾ç‰‡ï¼Œæ‚¨éœ€è¦åœ¨æŸ¥è¯¢ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„`_embed`å‚æ•°ã€‚å›åˆ°æ‚¨çš„ä»£ç ï¼ŒæŒ‰å¦‚ä¸‹æ–¹å¼æ›´æ”¹æŸ¥è¯¢å‚æ•°:

```
const posts = useSelect(
	( select ) => {
		return select( 'core' ).getEntityRecords( 'postType', 'post', {
			'per_page': numberOfItems,
			'_embed': true
		});
	},
	[ numberOfItems ]
);
```

è¿™é‡Œæˆ‘ä»¬ç®€å•åœ°å°†`'_embed': true`æ·»åŠ åˆ°å‚æ•°æ•°ç»„ä¸­ã€‚è¿™æä¾›äº†ä¸€ä¸ªåŒ…å«`_embedded`å±æ€§çš„`post`å¯¹è±¡ï¼Œå®ƒæä¾›äº†æ˜¾ç¤ºç‰¹è‰²å›¾ç‰‡æ‰€éœ€çš„å›¾ç‰‡ç»†èŠ‚ã€‚

ç°åœ¨ä½ åº”è¯¥çŸ¥é“åœ¨å“ªé‡Œ[æ‰¾åˆ°å›¾åƒç»†èŠ‚](#accessing-post-data-using-the-wordpress-rest-api)ã€‚

![Featured image details in getEntityRecords response.](img/af4cbfe53cd3bc553b92445eaef3ec55.png)

Featured image details in getEntityRecords response.



æ‚¨åªéœ€è¦æ·»åŠ åœ¨å±å¹•ä¸Šå‘ˆç°å›¾åƒçš„ä»£ç :

```
{
	displayThumbnail && 
	post._embedded && 
	post._embedded['wp:featuredmedia'] &&
	post._embedded['wp:featuredmedia'][0] &&
	<img 
	className='wp-block-author-box-author-plugin__post-thumbnail'
		src={ post._embedded['wp:featuredmedia'][0].media_details.sizes.medium.source_url }
		alt={ post._embedded['wp:featuredmedia'][0].alt_text }
	/>
}
```

ä¿å­˜æ–‡ä»¶ï¼Œåˆ‡æ¢åˆ°å—ç¼–è¾‘å™¨ï¼Œæ£€æŸ¥å½“`displayThumbnail`å±æ€§è®¾ç½®ä¸º`true`æ—¶å›¾åƒæ˜¯å¦æ­£ç¡®æ˜¾ç¤ºã€‚

![A list of posts with featured image, date and excerpt.](img/2b5fb2731e7a6f8c24ed10dadac93d8e.png)

A list of posts with featured image, date and excerpt.



### æ·»åŠ è¾¹æ æ§åˆ¶

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´ä½¿ç”¨åœ¨ *block.json* ä¸­è®¾ç½®çš„å±æ€§é»˜è®¤å€¼ã€‚ä½†æ˜¯ä»[æˆ‘ä»¬ä¹‹å‰çš„æ–‡ç« ](https://kinsta.com/blog/gutenberg-blocks/#define-attributes)ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬å¯ä»¥å®šä¹‰äº‹ä»¶å¤„ç†ç¨‹åºï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿä¸ºæ¯ä¸ªå±æ€§åˆ†é…è‡ªå®šä¹‰å€¼ã€‚

ä¸ºæ­¤ï¼Œæ‚¨å°†å‘[å—è®¾ç½®å·¥å…·æ¡](https://kinsta.com/blog/gutenberg-blocks/#settings-sidebar)æ·»åŠ ä¸€ç»„æ§ä»¶ã€‚åœ¨ *edit.js* ä¸­ï¼Œä»ç›¸åº”çš„åŒ…ä¸­å¯¼å…¥ä»¥ä¸‹ç»„ä»¶:

```
import { 
	useBlockProps,
	InspectorControls
} from '@wordpress/block-editor';

import {
	PanelBody,
	PanelRow,
	QueryControls,
	ToggleControl,
	RangeControl
} from '@wordpress/components';
```

*   `InspectorControls`:åŒ…å«å½±å“æ•´ä¸ªåŒºå—çš„ä¾§è¾¹æ è®¾ç½®(å‚è§ GitHub ä¸Šçš„[)](https://github.com/WordPress/gutenberg/blob/a84c037a0e62a344005054102544c34d7b970a6b/packages/block-editor/src/components/inspector-controls/README.md)
*   `PanelBody`:åœ¨è®¾ç½®ä¾§è¾¹æ ä¸­æ·»åŠ ä¸€ä¸ªå¯æŠ˜å çš„å®¹å™¨(å‚è§ GitHub ä¸Šçš„[)](https://github.com/WordPress/gutenberg/blob/a84c037a0e62a344005054102544c34d7b970a6b/packages/components/src/panel/README.md#panelbody)
*   `PanelRow`:ä¸ºä¾§è¾¹æ æ§ä»¶ç”Ÿæˆä¸€ä¸ªé€šç”¨å®¹å™¨(å‚è§ GitHub ä¸Šçš„[)](https://github.com/WordPress/gutenberg/blob/a84c037a0e62a344005054102544c34d7b970a6b/packages/components/src/panel/README.md#panelrow)
*   `QueryControls`:æä¾›å»ºç«‹æŸ¥è¯¢çš„è®¾ç½®æ§ä»¶(å‚è§ GitHub ä¸Šçš„[)](https://github.com/WordPress/gutenberg/tree/a84c037a0e62a344005054102544c34d7b970a6b/packages/components/src/query-controls)
*   `ToggleControl`:ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªåˆ‡æ¢æŒ‰é’®æ¥å¯ç”¨/ç¦ç”¨ç‰¹å®šé€‰é¡¹(å‚è§ GitHub ä¸Šçš„[)](https://github.com/WordPress/gutenberg/blob/a84c037a0e62a344005054102544c34d7b970a6b/packages/components/src/toggle-control/README.md)
*   `RangeControl`:ç”¨äºä»ä¸€ç³»åˆ—å¢é‡å€¼ä¸­è¿›è¡Œé€‰æ‹©(å‚è§ GitHub ä¸Šçš„[)](https://github.com/WordPress/gutenberg/tree/a84c037a0e62a344005054102544c34d7b970a6b/packages/components/src/range-control)

æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦æ›´æ–°`Edit`å‡½æ•°æ¥ä½¿ç”¨ç°åœ¨å¯ç”¨çš„æ§ä»¶ã€‚é¦–å…ˆï¼Œä¿®æ”¹`Edit`åŠŸèƒ½å¦‚ä¸‹:

```
export default function Edit( { attributes, setAttributes } ) {

	const { 
		numberOfItems, 
		columns, 
		displayExcerpt, 
		displayDate, 
		displayThumbnail
	} = attributes;

	const posts = useSelect(
		( select ) => {
			return select( 'core' ).getEntityRecords( 'postType', 'post', {
				'per_page': numberOfItems,
				'_embed': true
			});
		},
		[ numberOfItems ]
	);
	...
}
```

æ³¨æ„ä¼ é€’ç»™`Edit`å‡½æ•°çš„`setAttributes`å±æ€§ã€‚

ç°åœ¨ï¼Œæ‚¨å¯ä»¥å°†ç›¸åº”çš„å…ƒç´ æ·»åŠ åˆ° JSX ä»£ç ä¸­:

```
return (
	<>
		<InspectorControls>
			<PanelBody title={ __( 'Content Settings', 'author-plugin' ) }>
				<PanelRow>
					<QueryControls 
						numberOfItems={ numberOfItems }
						onNumberOfItemsChange={ ( value ) =>
							setAttributes( { numberOfItems: value } )
						}
						minItems={ 1 }
						maxItems={ 10 }
					/>
				</PanelRow>
				<PanelRow>
					<RangeControl
						label={ __( 'Number of Columns', 'author-plugin' ) }
						value={ columns }
						onChange={ ( value ) =>
							setAttributes( { columns: value } )
						}
						min={ 1 }
						max={ 4 }
						required
					/>
				</PanelRow>
				<PanelRow>
					<ToggleControl
						label={ __( 'Show Featured Image', 'author-plugin' ) }
						checked={ displayThumbnail }
						onChange={ () =>
							setAttributes( { displayThumbnail: ! displayThumbnail } )
						}
					/>
				</PanelRow>
				<PanelRow>
					<ToggleControl
						label={ __( 'Show Date', 'author-plugin' ) }
						checked={ displayDate }
						onChange={ () =>
							setAttributes( { displayDate: ! displayDate } )
						}
					/>
				</PanelRow>
				<PanelRow>
					<ToggleControl
						label={ __( 'Display Excerpt', 'author-plugin' ) }
						checked={ displayExcerpt }
						onChange={ () =>
							setAttributes( { displayExcerpt: ! displayExcerpt } )
						}
					/>
				</PanelRow>
			</PanelBody>
		</InspectorControls>
		<div { ...useBlockProps() }>
			...
		</div>
	</>
);
```

å“‡ï¼Œä»£ç çœŸå¤šï¼Œä¸æ˜¯å—ï¼Ÿä½†æ˜¯è¿™å¾ˆå®¹æ˜“ç†è§£ã€‚

è¿™é‡Œæœ€å€¼å¾—ä½ å…³æ³¨çš„å…ƒç´ å±æ€§æ˜¯`QueryControls`ä¸­çš„`onNumberOfItemsChange`å’Œ`RangeControl``ToggleControl`ä¸­çš„`onChange`ã€‚è¿™äº›å±æ€§è®¾ç½®äº†ä½¿ç”¨æˆ·èƒ½å¤Ÿå®šåˆ¶å—çš„å¤–è§‚å’Œ/æˆ–è¡Œä¸ºæ‰€éœ€çš„[äº‹ä»¶å¤„ç†ç¨‹åº](https://developer.mozilla.org/en-US/docs/Web/Events/Event_handlers)ã€‚

ä½ è¿˜ä¼šæ³¨æ„åˆ°æˆ‘ä»¬ä½¿ç”¨äº†`<>`å’Œ`</>`æ ‡ç­¾ï¼Œå®ƒä»¬æ˜¯å£°æ˜[ååº”ç‰‡æ®µ](https://reactjs.org/docs/fragments.html#short-syntax)çš„ç®€çŸ­è¯­æ³•ã€‚

ç°åœ¨ï¼Œä¿å­˜æ–‡ä»¶ï¼Œè¿›å…¥ç¼–è¾‘å™¨ï¼Œåˆ·æ–°é¡µé¢:

![Block settings.](img/855bd18959f4af4473e1982beda764ac.png)

Block settings.



ä¸œè¥¿éƒ½åœ¨é‡Œé¢å—ï¼Ÿç„¶åæˆ‘ä»¬ç»§ç»­ï¼Œæ·»åŠ å¸–å­ä½œè€…çš„è¯¦ç»†ä¿¡æ¯ã€‚

### æ‰¾åˆ°å¸–å­ä½œè€…

æ­£å¦‚æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ï¼Œæˆ‘ä»¬çš„å—å°†æ˜¾ç¤ºä¸å½“å‰å¸–å­ä½œè€…ç›¸åŒçš„æ–‡ç« åˆ—è¡¨ã€‚

ä¸ºäº†è·å¾—æ–‡ç« ä½œè€…çš„ IDï¼Œæ‚¨å°†ä»`core/editor`æ•°æ®å­˜å‚¨ä¸­å¯¼å…¥ [`getCurrentPostAttribute`é€‰æ‹©å™¨](https://developer.wordpress.org/block-editor/reference-guides/data/data-core-editor/#getcurrentpostattribute):

```
wp.data.select( 'core/editor' ).getCurrentPostAttribute( 'author' )
```

`getCurrentPostAttribute`è¿”å›å·²ä¿å­˜æ–‡ç« çš„å±æ€§å€¼ã€‚

ä¸€æ—¦è·å¾—ä½œè€… IDï¼Œå°±å¯ä»¥å¦‚ä¸‹æ‰€ç¤ºæ›´æ”¹æŸ¥è¯¢:

```
const posts = useSelect(
	( select ) => {

		const _authorId = select( 'core/editor' ).getCurrentPostAttribute( 'author' );

		return select( 'core' ).getEntityRecords( 'postType', 'post', {
			'author': _authorId,
			'per_page': numberOfItems,
			'_embed': true
		});
	},
	[ numberOfItems ]
);
```

ä½¿ç”¨è¿™æ®µä»£ç ï¼Œæ‚¨å°†è·å¾—ä¸å½“å‰å¸–å­ä½œè€…ç›¸åŒçš„ä¸€ç³»åˆ—`n`æ–‡ç« ã€‚

ç°åœ¨æ‚¨å·²ç»æœ‰äº†ä½œè€… IDï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨å®ƒä»æ•°æ®åº“ä¸­è·å–é¢å¤–çš„æ•°æ®ã€‚

### æ˜¾ç¤ºä½œè€…è¯¦ç»†ä¿¡æ¯

ç”±äºæˆ‘ä»¬æ²¡æœ‰ä»»ä½•å¯ç”¨çš„æ–‡æ¡£ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ¥è‡ª[æ ¸å¿ƒå¸–å­ä½œè€…æ¨¡å—](https://github.com/WordPress/gutenberg/blob/trunk/packages/block-library/src/post-author/edit.js)çš„ä»£ç ä½œä¸ºå‚è€ƒã€‚

è¦æ˜¾ç¤ºä½œè€…çš„è¯¦ç»†ä¿¡æ¯ï¼Œé¦–å…ˆéœ€è¦å¯¼å…¥ä¸€ä¸ªæ–°çš„ä¾èµ–å…³ç³»:

```
import { forEach } from 'lodash';
```

ç„¶åï¼Œåœ¨`Edit`å‡½æ•°ä¸­ï¼Œæ›´æ–°`attributes`å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
const { 
	numberOfItems, 
	columns, 
	displayExcerpt, 
	displayDate, 
	displayThumbnail, 
	displayAuthorInfo, 
	showAvatar, 
	avatarSize, 
	showBio 
} = attributes;
```

å®Œæˆåï¼Œæ‚¨å°†ç¼–è¾‘ä¸Šä¸€èŠ‚ä¸­çœ‹åˆ°çš„ä»£ç æ¥æ£€ç´¢ä½œè€…çš„è¯¦ç»†ä¿¡æ¯:

```
const { authorDetails, posts } = useSelect(
	( select ) => {

		const _authorId = select( 'core/editor' ).getCurrentPostAttribute( 'author' );

		const authorDetails = _authorId ? select( 'core' ).getUser( _authorId ) : null;

		const posts = select( 'core' ).getEntityRecords( 'postType', 'post', {
			'author': _authorId,
			'per_page': numberOfItems,
			'_embed': true
		});

		return { 
			authorDetails: authorDetails,
			posts: posts
		};
	},
	[ numberOfItems ]
);
```

æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† [`getUser`é€‰æ‹©å™¨](#getusers)æ¥è·å–ä½œè€…çš„è¯¦ç»†ä¿¡æ¯ã€‚

æ¥ä¸‹æ¥ï¼Œä½ å¯èƒ½æƒ³å¾—åˆ°ä½œè€…çš„å¤´åƒã€‚ä¸‹é¢çš„ä»£ç æ„å»ºäº†ä¸€ä¸ªå­˜å‚¨å¤´åƒ URL å’Œå¤§å°çš„é¡¹ç›®æ•°ç»„:

```
const avatarSizes = [];
if ( authorDetails ) {
	forEach( authorDetails.avatar_urls, ( url, size ) => {
		avatarSizes.push( {
			value: size,
			label: `${ size } x ${ size }`,
		} );
	} );
}
```

ç„¶åï¼Œæ‚¨å°†æ·»åŠ ä¾§è¾¹æ é¢æ¿å’Œæ§ä»¶ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå®šåˆ¶å—ä¸­çš„ä½œè€…åŒºåŸŸ:

```
return (
	<>
		<InspectorControls>
			<PanelBody title={ __( 'Author Info', 'author-plugin' ) }>
				<PanelRow>
					<ToggleControl
						label={ __( 'Display Author Info', 'author-plugin' ) }
						checked={ displayAuthorInfo }
						onChange={ () =>
							setAttributes( { displayAuthorInfo: ! displayAuthorInfo } )
						}
					/>
				</PanelRow>
				{ displayAuthorInfo && (
					<>
						<PanelRow>
							<ToggleControl
								label={ __( 'Show avatar' ) }
								checked={ showAvatar }
								onChange={ () =>
									setAttributes( { showAvatar: ! showAvatar } )
								}
							/>
							{ showAvatar && (
								<SelectControl
									label={ __( 'Avatar size' ) }
									value={ avatarSize }
									options={ avatarSizes }
									onChange={ ( size ) => {
										setAttributes( {
											avatarSize: Number( size ),
										} );
									} }
								/>
							) }
						</PanelRow>
						<PanelRow>
							<ToggleControl
								label={ __( 'Show Bio', 'author-plugin' ) }
								checked={ showBio }
								onChange={ () =>
									setAttributes( { showBio: ! showBio } )
								}
							/>
						</PanelRow>
					</>
				) }
			</PanelBody>
			...
		</InspectorControls>
		...
	</>
);
```

ä¸‹å›¾æ˜¾ç¤ºäº†æ›´æ–°åçš„è®¾ç½®è¾¹æ :

![The Author Info settings panel.](img/b7d53c144e8eb05590b48288abde7094.png)

The Author Info settings panel.



æœ€åï¼Œæ‚¨å¯ä»¥å°†ä½œè€…éƒ¨åˆ†æ·»åŠ åˆ°æ‚¨çš„å—ä¸­:

```
return (
	<>
		<InspectorControls>
		...
		</InspectorControls>

		<div { ...useBlockProps() }>
			{ displayAuthorInfo  && authorDetails && (
				<div className="wp-block-author-box-author-plugin__author">
					{ showAvatar && (
						<div className="wp-block-author-box-author-plugin__avatar">
							<img
								width={ avatarSize }
								src={
									authorDetails.avatar_urls[
										avatarSize
									]
								}
								alt={ authorDetails.name }
							/>
						</div>
					) }
					<div className='wp-block-author-box-author-plugin__author-content'>
						<p className='wp-block-author-box-author-plugin__name'>
							{ authorDetails.name }
						</p>
						{ showBio &&
							// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining
							authorDetails?.description &&
							authorDetails.description.length > 0 && (
							<p className='wp-block-author-box-author-plugin__description'>{ authorDetails.description }</p>
						) }
					</div>
				</div>
			)}
			<ul>
			...
			</ul>
		</div>
	</>
);
```

ä¸‹å›¾æ˜¾ç¤ºäº†å®ƒåœ¨å±å¹•ä¸Šçš„å‘ˆç°æ–¹å¼ã€‚

![Author details section and Info settings.](img/b0dd234aa7c4aed3ae71982dcc69f8ef.png)

Author details section and Info settings.



ç°åœ¨ä¿å­˜æ‚¨çš„ *edit.js* æ–‡ä»¶å¹¶è¿è¡Œæ‚¨çš„æµ‹è¯•ã€‚æ ¹æ®å—è®¾ç½®ï¼Œå—åº”åŒ…å«ä¸åŒçš„å…ƒç´ ã€‚

![Author details not showing author's bio.](img/fb61a9539007e8c218ffde3fee3db7b0.png)

Author details not showing authorâ€™s bio.



è¿˜ç¼ºå°‘æœ€åä¸€æ ·ä¸œè¥¿:æ˜¾ç¤ºæ–‡ç« çš„åˆ—æ•°ã€‚

### æ›´æ”¹åˆ—æ•°

ä¸ºäº†è®©ç”¨æˆ·èƒ½å¤Ÿä»¥åˆ—çš„å½¢å¼æ˜¾ç¤ºæ–‡ç« é¢„è§ˆï¼Œæˆ‘ä»¬åœ¨ *block.json* æ–‡ä»¶ä¸­å®šä¹‰äº†`columns`å±æ€§ã€‚æˆ‘ä»¬è¿˜åœ¨è„šæœ¬ä¸­åŒ…å«äº†ä¸€ä¸ª`columns`å±æ€§ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªè®¾ç½®æ§ä»¶æ¥å…è®¸ç”¨æˆ·æ›´æ”¹åˆ—æ•°ï¼Œå°½ç®¡è¿™ä¸€æ›´æ”¹ç›®å‰æ²¡æœ‰æ•ˆæœã€‚

åœ¨ä¸Šé¢çš„ JSX ä»£ç ä¸­ï¼Œä½ åº”è¯¥å·²ç»æ³¨æ„åˆ°æˆ‘ä»¬åœ¨å‡ ä¸ªå…ƒç´ ä¸­æ·»åŠ äº† CSS ç±»:

åˆ†é…ç»™ Author éƒ¨åˆ†ä¸­çš„å…ƒç´ çš„ç±»:

*   `wp-block-author-box-author-plugin__author`
*   `wp-block-author-box-author-plugin__avatar`
*   `wp-block-author-box-author-plugin__author-content`
*   `wp-block-author-box-author-plugin__name`
*   `wp-block-author-box-author-plugin__description`

åˆ†é…ç»™å†…å®¹éƒ¨åˆ†ä¸­å…ƒç´ çš„ç±»:

*   `wp-block-author-box-author-plugin__post-items`
*   `wp-block-author-box-author-plugin__post-thumbnail`
*   `wp-block-author-box-author-plugin__post-title`
*   `wp-block-author-box-author-plugin__post-date`
*   `wp-block-author-box-author-plugin__post-excerpt`

è¿˜æœ‰ä¸€èŠ‚è¯¾æ²¡ä¸Šã€‚è¯¥ç±»çš„åç§°å°†åŠ¨æ€ç”Ÿæˆï¼Œä»¥åæ˜ ç”¨æˆ·è®¾ç½®çš„åˆ—æ•°ã€‚

è¿”å›åˆ°`Edit.js`æ–‡ä»¶ï¼Œä¿®æ”¹`ul`å…ƒç´ ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
<ul className={ `wp-block-author-box-author-plugin__post-items columns-${ columns }` }>
	...
</ul>
```

æˆ‘ä»¬æ ¹æ®[æ¨¡æ¿æ–‡å­—](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)è¯­æ³•æ·»åŠ äº†ä¸€ä¸ªæ–°çš„`columns-${ columns }`ç±»ï¼Œä»¥ä¾¿åœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥ä¸€ä¸ªè¡¨è¾¾å¼ã€‚è¿™æ ·ï¼Œé™„åŠ åˆ°`ul`å…ƒç´ çš„å±æ€§å°†å–å†³äºç”¨æˆ·è®¾ç½®(ä¾‹å¦‚`columns-1`ã€`columns-2`ç­‰)ã€‚).

ç°åœ¨æ‰“å¼€`style.scss`æ–‡ä»¶ï¼Œç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢ç°æœ‰ä»£ç :

```
.wp-block-author-box-author-plugin {
	background-color: #21759b;
	color: #fff;
	padding: .6em;
	ul.wp-block-author-box-author-plugin__post-items {
		padding: 0;
		list-style-type: none;
		display: grid;
		gap: .5em;
		@for $i from 2 through 4 {
			&.columns-#{ $i } {
				grid-template-columns: repeat(#{ $i }, 1fr);
			}
		}
		li {
			list-style: none;
			img.wp-block-author-box-author-plugin__post-thumbnail {
				height: auto;
				max-width: 100%;
			}
		}

	}
}
.wp-block-author-box-author-plugin__author {
	display: flex;
    flex-wrap: wrap;
}

.wp-block-author-box-author-plugin__avatar {
	margin-right: 1em;
}

.wp-block-author-box-author-plugin__author-content {
	flex-basis: 0;
    flex-grow: 1;
}
```

æˆ‘ä»¬ä¸ä¼šæ·±å…¥ç ”ç©¶è¿™äº›ä»£ç ï¼Œå› ä¸ºè¿™è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å¸Œæœ›æ·±å…¥äº†è§£ï¼Œæ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹èµ„æº:

*   [CSS ç½‘æ ¼å¸ƒå±€](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Grid_Layout)
*   [å­¦ä¹  CSS ç½‘æ ¼](https://learncssgrid.com/)
*   [Sass ä¸­çš„@for è§„åˆ™](https://sass-lang.com/documentation/at-rules/control/for)
*   [åœ¨ Sass ä¸­åµŒå¥—](https://sass-lang.com/documentation/style-rules#nesting)

![The Author block in the editor.](img/f8694b9f3d9a543894528eea17a2c4c0.png)

The Author block in the editor.



è¿™å°±æ˜¯ç¼–è¾‘å™¨ä¸­å—çš„æ¸²æŸ“ã€‚

## æ„å»ºè¦åœ¨é¡µé¢ä¸Šå‘ˆç°çš„å—

ç°åœ¨ï¼Œåœ¨ç¼–è¾‘å™¨ä¸­å‘ˆç°å—çš„ä»£ç å·²ç»å®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ„å»ºç”¨äºåœ¨å‰ç«¯å‘ˆç°çš„å—ã€‚

æ­£å¦‚æˆ‘ä»¬å‰é¢æåˆ°çš„ï¼Œå¯¹äºåŠ¨æ€å—ï¼Œæ’ä»¶æ–‡ä»¶è´Ÿè´£ç”Ÿæˆè¦åœ¨å‰ç«¯å‘ˆç°çš„ HTMLã€‚

æ‰€ä»¥ï¼Œæ‰“å¼€æ’ä»¶çš„ä¸»æ–‡ä»¶(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯*author-plugin.php*)ã€‚

é¦–å…ˆè¦åšçš„æ˜¯ä½¿ block å±æ€§å¯¹ WordPress PHP å‡½æ•°å¯ç”¨ã€‚åœ¨æ‚¨çš„ PHP æ–‡ä»¶ä¸­ï¼ŒæŒ‰å¦‚ä¸‹æ–¹å¼æ›´æ”¹å‡½æ•°å®šä¹‰:

```
function author_box_author_plugin_render_author_content( $attr ) {
	...
}
```

ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨ WordPress å‡½æ•°æ¥æ£€ç´¢å’Œæ“ä½œæ•°æ®ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`get_posts`æ¥æ£€ç´¢æœ€æ–°çš„åšå®¢æ–‡ç« (åœ¨æˆ‘ä»¬å…³äº [`get_posts`åŠŸèƒ½](https://kinsta.com/blog/wordpress-get_posts/)çš„æ·±å…¥æ–‡ç« ä¸­å¯ä»¥è¯»åˆ°æ›´å¤š):

```
function author_box_author_plugin_render_author_content( $attr ) {
	$args = array(
		'numberposts'	=> $attr['numberOfItems'],
	);
	$my_posts = get_posts( $args );

	if( ! empty( $my_posts ) ){
		$output = '<ul>';
		foreach ( $my_posts as $p ){
			$output .= '<li><a href="' . esc_url( get_permalink( $p->ID ) ) . '">' 
			. $p->post_title . '</a></li>';
		}
		$output .= '</ul>';
	}
	return $output ?? '<strong>Sorry. No posts matching your criteria!</strong>';
}
```

ä¸Šé¢çš„å‡½æ•°ä»ä½ çš„ WordPress æ•°æ®åº“ä¸­æ£€ç´¢æœ€æ–°çš„`numberOfItems`åšå®¢æ–‡ç« (é»˜è®¤æƒ…å†µä¸‹`post_type`è¢«è®¾ç½®ä¸º`post`)å¹¶è¿”å›ä¸€ä¸ª`$post`å¯¹è±¡æ•°ç»„ã€‚ç„¶åéå†æ•°ç»„æ¥æ„å»ºåˆ—è¡¨é¡¹ã€‚

å¦‚æœæ£€æŸ¥ HTML è¾“å‡ºï¼Œæ‚¨ä¼šæ³¨æ„åˆ°è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å¸–å­åˆ—è¡¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:

![A simple list of posts.](img/05b88fa23426ee438f0a6eb8d613e39f.png)

A simple list of posts.



åœ¨æˆ‘ä»¬ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æåˆ°è¿‡ä½ å°†ä½¿ç”¨`useBlockProps` React é’©å­åœ¨ä½ çš„ JSX ä»£ç ä¸­æ ‡è®°å—çš„[åŒ…è£…å…ƒç´ ](https://kinsta.com/blog/gutenberg-blocks/#import-components)ã€‚æ‚¨éœ€è¦åœ¨ PHP å‡½æ•°ä¸­åšåŒæ ·çš„äº‹æƒ…ã€‚

WordPress ä¸ºæ­¤æä¾›äº† [`get_block_wrapper_attributes`å‡½æ•°](https://developer.wordpress.org/reference/functions/get_block_wrapper_attributes/)ã€‚

å› æ­¤ï¼ŒæŒ‰å¦‚ä¸‹æ–¹å¼æ›´æ”¹æ‚¨çš„ PHP ä»£ç :

```
function author_box_author_plugin_render_author_content( $attr ) {
	$args = array(
		'numberposts'	=> $attr['numberOfItems']
	);
	$my_posts = get_posts( $args );

	if( ! empty( $my_posts ) ){
		$output = '<div ' . get_block_wrapper_attributes() . '>';
		$output .= '<ul>';
		foreach ( $my_posts as $p ){

			$title = $p->post_title ? $p->post_title : 'Default title';
			$url = esc_url( get_permalink( $p->ID ) );

			$output .= '<li>';
			$output .= '<a href="' . $url . '">' . $title . '</a>';
			$output .= '</li>';
		}
		$output .= '</ul>';
		$output .= '</div>';
	}
	return $output ?? '<strong>Sorry. No posts matching your criteria!</strong>';
}
```

ç°åœ¨ä¸€ä¸ª [`wp-block-author-box-author-plugin`ç±»](https://developer.wordpress.org/reference/functions/get_block_wrapper_attributes/)å·²ç»è¢«åˆ†é…ç»™å®¹å™¨å…ƒç´ ï¼Œè¿™ä¸ªå—æœ‰äº†ä¸åŒçš„èƒŒæ™¯é¢œè‰²ã€‚

ç„¶å`get_posts`å‡½æ•°è·å–`WP_Posts`æ•°æ®ï¼Œ`foreach`å¾ªç¯æ„å»ºåˆ—è¡¨é¡¹(å‚è§[å¦‚ä½•æ˜¾ç¤º get_posts è¿”å›çš„æ•°æ®](https://kinsta.com/blog/wordpress-get_posts/#display))ã€‚

![A list of posts with a CSS class assigned.](img/59b405b1495f73ea5d1cf90db3e818eb.png)

A list of posts with a CSS class assigned.



### æ·»åŠ ç‰¹è‰²å›¾ç‰‡ã€æ—¥æœŸå’Œæ‘˜å½•

æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦æ·»åŠ æ–‡ç« ç¼©ç•¥å›¾ã€æ—¥æœŸå’Œæ‘˜å½•ã€‚åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå°†æ‚¨çš„ PHP ä»£ç æ›´æ”¹å¦‚ä¸‹:

```
function author_box_author_plugin_render_author_content( $attr ) {
	$args = array(
		'numberposts'	=> $attr['numberOfItems']
	);
	$my_posts = get_posts( $args );

	if( ! empty( $my_posts ) ){
		$output = '<div ' . get_block_wrapper_attributes() . '>';
		$output .= '<ul class="wp-block-author-box-author-plugin__post-items columns-">';

		foreach ( $my_posts as $p ){

			$title = $p->post_title ? $p->post_title : 'Default title';
			$url = esc_url( get_permalink( $p->ID ) );
			$thumbnail = has_post_thumbnail( $p->ID ) ? get_the_post_thumbnail( $p->ID, 'medium' ) : '';

			$output .= '<li>';
			if( ! empty( $thumbnail ) && $attr['displayThumbnail'] ){
				$output .= $thumbnail;
			}
			$output .= '<h5><a href="' . $url . '">' . $title . '</a></h5>';
			if( $attr['displayDate'] ){
				$output .= '<time datetime="' . esc_attr( get_the_date( 'c', $p ) ) . '">' . esc_html( get_the_date( '', $p ) ) . '</time>';
			}
			if( get_the_excerpt( $p ) && $attr['displayExcerpt'] ){
				$output .= '<p>' . get_the_excerpt( $p ) . '</p>';
			}
			$output .= '</li>';
		}
		$output .= '</ul>';
		$output .= '</div>';
	}
	return $output ?? '<strong>Sorry. No posts matching your criteria!</strong>';
}
```

`foreach`å¾ªç¯éå†`$my_posts`æ•°ç»„ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæœ‰å‡ ä¸ªæ¡ä»¶ä¼šæ£€æŸ¥å±æ€§å€¼å¹¶ç›¸åº”åœ°æ„å»ºè¾“å‡ºã€‚

ç°åœ¨çœ‹çœ‹å±å¹•ä¸Šçš„è¾“å‡º:

![A list of posts with featured images, dates, and excerpts.](img/820464b5cf31f9a708bc03d0bcbd80b3.png)

A list of posts with featured images, dates, and excerpts.



ç°åœ¨ä½ å¯ä»¥è¿è¡Œä½ çš„æµ‹è¯•äº†ã€‚æ›´æ”¹æ—¥æœŸã€æ‘˜å½•å’Œç¼©ç•¥å›¾è®¾ç½®ï¼Œå¹¶æ£€æŸ¥å—å†…å®¹å¦‚ä½•åœ¨å‰ç«¯å‘ç”Ÿå˜åŒ–ã€‚

### åœ¨åˆ—ä¸­æ˜¾ç¤ºå¸–å­

åœ¨æˆ‘ä»¬çš„ JavaScript ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª`columns-${ columns }`ç±»åœ¨åˆ—ä¸­æ˜¾ç¤ºæ–‡ç« é¢„è§ˆã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨ PHP ä¸­åšåŒæ ·çš„äº‹æƒ…ã€‚

ä¸ºæ­¤ï¼Œæ‚¨åªéœ€æ·»åŠ è¿™ä¸¤è¡Œä»£ç :

```
$num_cols = $attr['columns'] > 1 ? strval( $attr['columns'] ) : '1';

$output .= '<ul class="wp-block-author-box-author-plugin__post-items columns-' . $num_cols . '">';
```

è¿™å°†æŠŠä¸€ä¸ª`columns-n`ç±»é™„åŠ åˆ°åŒ…å«æ–‡ç« é¢„è§ˆçš„`ul`å…ƒç´ ä¸­ã€‚ç°åœ¨ï¼Œé¡µé¢ä¸Šæ˜¾ç¤ºçš„åˆ—æ•°åº”è¯¥ä¸å—è®¾ç½®ä¸­è®¾ç½®çš„åˆ—æ•°ç›¸åŒ¹é…ã€‚

### æ„å»ºä½œè€…æ¡†

æœ€åï¼Œæ‚¨éœ€è¦æ„å»ºåŒ…å«ä½œè€…è¯¦ç»†ä¿¡æ¯çš„ç›’å­ï¼ŒåŒ…æ‹¬å¤´åƒã€å§“åå’Œæè¿°ã€‚

åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œæ‚¨éœ€è¦æ·»åŠ ä¸€ç»„æ¡ä»¶æ¥æ£€æŸ¥æ¯ä¸ªå±æ€§çš„å½“å‰å€¼:

```
if( $attr['displayAuthorInfo'] ){
	$output .= '<div class="wp-block-author-box-author-plugin__author">';

	if( $attr['showAvatar'] ){
		$output .= '<div class="wp-block-author-box-author-plugin__avatar">' 
			. get_avatar( get_the_author_meta( 'ID' ), $attr['avatarSize'] ) 
			. '</div>';
	}

	$output .= '<div class="wp-block-author-box-author-plugin__author-content">';

	$output .= '<div class="wp-block-author-box-author-plugin__name">' 
		. get_the_author_meta( 'display_name' ) 
		. '</div>';

	if( $attr['showBio'] ){
		$output .= '<div class="wp-block-author-box-author-plugin__description">' 
			. get_the_author_meta( 'description' ) 
			. '</div>';
	}

	$output .= '</div>';
	$output .= '</div>';
}
```

ä»£ç éå¸¸ç®€å•ã€‚å®ƒæ£€æŸ¥æ¯ä¸ªå±æ€§çš„å½“å‰å€¼ï¼Œå¦‚æœæ˜¯`true`ï¼Œé‚£ä¹ˆå®ƒç”Ÿæˆå¿…è¦çš„ HTMLã€‚

ç°åœ¨ä¿å­˜æ‚¨çš„ PHP æ–‡ä»¶ï¼Œå¹¶æ¯”è¾ƒç¼–è¾‘å™¨ä¸­çš„ä»£ç å—å’Œå‰ç«¯çš„ç›¸åŒä»£ç å—ã€‚

![Our custom block in the block editor.](img/b71441aab51a9bd8336fca760f58dd1b.png)

Our custom block in the block editor.



ä½ å¯ä»¥åœ¨[è¿™ä¸ªå…¬å…±è¦ç‚¹](https://gist.github.com/carlodaniele/27e292fbbe4b897ca3bda4539dfd74df)ä¸­æ‰¾åˆ°ç¤ºä¾‹å—çš„å®Œæ•´ä»£ç ã€‚

[Dynamic blocks are Gutenberg blocks under steroids ğŸ’ª and this guide covers all you need to know to create dynamic blocks for your next project ğŸ™ŒClick to Tweet](https://twitter.com/intent/tweet?url=https%3A%2F%2Fbit.ly%2F3zS8lhf&via=kinsta&text=Dynamic+blocks+are+Gutenberg+blocks+under+steroids+%F0%9F%92%AA+and+this+guide+covers+all+you+need+to+know+to+create+dynamic+blocks+for+your+next+project+%F0%9F%99%8C&hashtags=Gutenberg%2CDevelopment)

## åŠ¨æ€å—å¼€å‘çš„æ¨èèµ„æº

å¦‚æœä½ åœ¨é˜…è¯»è¿™ç¯‡æ–‡ç« æ—¶ç«–èµ·äº†è€³æœµï¼Œå¹¶å¼€å§‹è®¤è¯†åˆ°å­¦ä¹ å¦‚ä½•åˆ›å»ºå¤è…¾å ¡ç§¯æœ¨æ‰€å¸¦æ¥çš„ä¸“ä¸šå‘å±•æœºä¼šï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬çš„å»ºè®®æ˜¯ç»§ç»­æ¢ç´¢å’Œè·å–ç§¯æœ¨å¼€å‘èƒŒåçš„æ–°æŠ€æœ¯ã€‚

è™½ç„¶ä»ç„¶ç¼ºå°‘å¯é çš„å®˜æ–¹æ–‡æ¡£ï¼Œä½†æ˜¯ä»ç„¶æœ‰å¾ˆå¥½çš„èµ„æºï¼Œæ— è®ºæ˜¯å…è´¹çš„è¿˜æ˜¯ä»˜è´¹çš„ï¼Œæˆ‘ä»¬åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™å‚è€ƒäº†è¿™äº›èµ„æºã€‚åœ¨ä¼—å¤šå¯ç”¨èµ„æºä¸­ï¼Œæˆ‘ä»¬æ¨èä»¥ä¸‹èµ„æº:

**å®˜æ–¹èµ„æº**

*   [æ•°æ®](https://github.com/WordPress/gutenberg/blob/trunk/packages/data/README.md)
*   [æ ¸å¿ƒæ•°æ®](https://github.com/WordPress/gutenberg/blob/trunk/packages/core-data/README.md)
*   [åˆ›å»ºåŠ¨æ€å—](https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/creating-dynamic-blocks/)
*   [å¤è…¾å ¡åŒºå—å¼€å‘ç®€ä»‹](https://learn.wordpress.org/workshop/intro-to-gutenberg-block-development/)
*   MeetUp ä¸Šçš„ç¤¾äº¤å­¦ä¹ 

æ¥è‡ª WordPress æ ¸å¿ƒè´¡çŒ®è€…çš„æ¨èæ•™ç¨‹

*   Ryan Welcher(@[ryanwelcher](https://twitter.com/ryanwelcher))ä½¿ç”¨ getEntityRecords åœ¨å¤è…¾å ¡è¯·æ±‚æ•°æ®
*   Darren Ethier (@ [nerrad](https://twitter.com/nerrad) )å¯¹@wordpress/data API çš„å®ç”¨æ¦‚è¿°

**JavaScriptã€React å’Œ Redux èµ„æº**

*   MDN çš„ JavaScript æ•™ç¨‹
*   ã€React å…¥é—¨(å®˜æ–¹)
*   [Redux æ•™ç¨‹](https://redux.js.org/tutorials/essentials/part-1-overview-concepts)(å®˜æ–¹)

**æ¥è‡ª Kinsta çš„ç›¸å…³èµ„æº**

*   [JavaScript æ˜¯ä»€ä¹ˆï¼Ÿçœ‹çœ‹ç½‘ç»œä¸Šæœ€æµè¡Œçš„è„šæœ¬è¯­è¨€](https://kinsta.com/knowledgebase/what-is-javascript/)
*   å¤„ç† JavaScript é”™è¯¯çš„æƒå¨æŒ‡å—
*   [ä»€ä¹ˆæ˜¯ Node.jsï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒ](https://kinsta.com/knowledgebase/what-is-node-js/)
*   [å¦‚ä½•åœ¨ Windowsã€macOSã€Linux ä¸Šå®‰è£… Node.js å’Œ NPM](https://kinsta.com/blog/how-to-install-node-js/)
*   [å¦‚ä½•ä½¿ç”¨å¤šç§å·¥å…·è°ƒè¯• Node.js ä»£ç ](https://kinsta.com/blog/node-debug/)
*   Node.js ä¸ PHP:åŠ¿å‡åŠ›æ•Œçš„æ¯”è¾ƒ
*   [2022 å¹´æœ€å—æ¬¢è¿çš„ 10 ç§ Node.js åº”ç”¨](https://kinsta.com/blog/node-js-apps/)
*   [è§’åº¦ä¸ååº”:è¯¦ç»†çš„å¹¶æ’æ¯”è¾ƒ](https://kinsta.com/blog/angular-vs-react/)

## æ‘˜è¦

æˆ‘ä»¬å·²ç»åˆ°è¾¾å¤è…¾å ¡åŒºå—å¼€å‘è¿™ä¸€(ç¬¬äºŒ)æ¼«é•¿æ—…ç¨‹çš„ç»ˆç‚¹ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä¸€äº›é«˜çº§ä¸»é¢˜ï¼Œæ¯”å¦‚åº”ç”¨ç¨‹åºçŠ¶æ€å’Œ Redux å­˜å‚¨ã€‚ä½†æ˜¯å¸Œæœ›æ‚¨ç°åœ¨åº”è¯¥å¯¹å—å¼€å‘æœ‰äº†æ›´å¥½çš„ç†è§£ã€‚

æ˜¯çš„ï¼ŒNode.jsã€Webpackã€ [Babel](https://kinsta.com/blog/transpiling-php/#what-is-transpiling) ã€React å’Œ Redux æŠ€èƒ½åœ¨æ„å»ºé«˜çº§å¤è…¾å ¡ç§¯æœ¨æ—¶å¿…ä¸å¯å°‘ï¼Œä½†ä½ ä¸éœ€è¦æˆä¸º React å¿è€…æ‰èƒ½å…¥é—¨ã€‚å­¦ä¹ å¦‚ä½•å¼€å‘å¤è…¾å ¡åŒºå—å¹¶ä¸ä¸€å®šè¦å¤æ‚ã€‚åªè¦æœ‰æ­£ç¡®çš„åŠ¨æœºå¹¶éµå¾ªé€‚å½“çš„å­¦ä¹ è·¯å¾„å°±å¯ä»¥äº†ã€‚

æˆ‘ä»¬å¸Œæœ›è¿™ç¯‡æ–‡ç« ä»¥åŠä¸Šä¸€ç¯‡æ–‡ç« ä¸ºä½ æä¾›æ­£ç¡®çš„åœ°å›¾ï¼Œè®©ä½ æ‰¾åˆ°è‡ªå·±çš„é“è·¯ï¼Œå¹¶ç«‹å³å¼€å§‹å¤è…¾å ¡çš„å‘å±•ã€‚

*ç°åœ¨ç”±ä½ å†³å®šï¼ä½ åˆ›å»ºåŠ¨æ€å—äº†å—ï¼Ÿä½ æœ‰ä»€ä¹ˆä¾‹å­å¯ä»¥å’Œæˆ‘ä»¬åˆ†äº«å—ï¼Ÿä½ ç»å†ä¸­æœ€å¤§çš„éšœç¢æ˜¯ä»€ä¹ˆï¼Ÿæ¬¢è¿åœ¨ä¸‹é¢å‘è¡¨è¯„è®ºã€‚*

* * *

è®©ä½ æ‰€æœ‰çš„[åº”ç”¨ç¨‹åº](https://kinsta.com/application-hosting/)ã€[æ•°æ®åº“](https://kinsta.com/database-hosting/)å’Œ [WordPress ç½‘ç«™](https://kinsta.com/wordpress-hosting/)åœ¨çº¿å¹¶åœ¨ä¸€ä¸ªå±‹æªä¸‹ã€‚æˆ‘ä»¬åŠŸèƒ½ä¸°å¯Œçš„é«˜æ€§èƒ½äº‘å¹³å°åŒ…æ‹¬:

*   åœ¨ MyKinsta ä»ªè¡¨ç›˜ä¸­è½»æ¾è®¾ç½®å’Œç®¡ç†
*   24/7 ä¸“å®¶æ”¯æŒ
*   æœ€å¥½çš„è°·æ­Œäº‘å¹³å°ç¡¬ä»¶å’Œç½‘ç»œï¼Œç”± Kubernetes æä¾›æœ€å¤§çš„å¯æ‰©å±•æ€§
*   é¢å‘é€Ÿåº¦å’Œå®‰å…¨æ€§çš„ä¼ä¸šçº§ Cloudflare é›†æˆ
*   å…¨çƒå—ä¼—è¦†ç›–å…¨çƒå¤šè¾¾ 35 ä¸ªæ•°æ®ä¸­å¿ƒå’Œ 275 å¤šä¸ª pop

åœ¨ç¬¬ä¸€ä¸ªæœˆä½¿ç”¨æ‰˜ç®¡çš„[åº”ç”¨ç¨‹åºæˆ–æ‰˜ç®¡](https://kinsta.com/application-hosting/)çš„[æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥äº«å— 20 ç¾å…ƒçš„ä¼˜æƒ ï¼Œäº²è‡ªæµ‹è¯•ä¸€ä¸‹ã€‚æ¢ç´¢æˆ‘ä»¬çš„](https://kinsta.com/database-hosting/)[è®¡åˆ’](https://kinsta.com/plans/)æˆ–[ä¸é”€å”®äººå‘˜äº¤è°ˆ](https://kinsta.com/contact-us/)ä»¥æ‰¾åˆ°æœ€é€‚åˆæ‚¨çš„æ–¹å¼ã€‚